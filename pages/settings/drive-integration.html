<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Drive Entegrasyonu - IHSAN AI</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Manrope:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../assets/css/main.css">
  <script src="https://unpkg.com/htmx.org@1.9.10"></script>
</head>
<body>
  <div class="gradient-mesh"></div>
  <div class="app-container">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <img src="../../logo.png" alt="IHSAN AI" onerror="this.style.display='none'; this.parentElement.innerHTML='IA';">
        </div>
        <div class="sidebar-brand">
          <h1>IHSAN AI</h1>
          <span>Sigorta Yonetim</span>
        </div>
      </div>
      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Ana Menu</div>
          <div class="nav-item">
            <a href="../../index.html" class="nav-link">
              <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="7" height="7" rx="1"/>
                <rect x="14" y="3" width="7" height="7" rx="1"/>
                <rect x="3" y="14" width="7" height="7" rx="1"/>
                <rect x="14" y="14" width="7" height="7" rx="1"/>
              </svg>
              <span class="nav-text">Dashboard</span>
            </a>
          </div>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Police Islemleri</div>
          <div class="nav-item has-submenu">
            <a href="#" class="nav-link">
              <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                <polyline points="14,2 14,8 20,8"/>
              </svg>
              <span class="nav-text">Policeler</span>
              <svg class="nav-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6,9 12,15 18,9"/>
              </svg>
            </a>
            <div class="nav-submenu">
              <a href="../policies/my-policies.html" class="nav-link"><span class="nav-text">Policelerim</span></a>
              <a href="../policies/captured.html" class="nav-link"><span class="nav-text">Yakalanan Policeler</span></a>
              <a href="../policies/pool.html" class="nav-link"><span class="nav-text">Police Havuzu</span></a>
              <a href="../policies/add-manual.html" class="nav-link"><span class="nav-text">Manuel Police Ekle</span></a>
              <a href="../policies/bulk-import.html" class="nav-link"><span class="nav-text">Toplu Aktar</span></a>
            </div>
          </div>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Yonetim</div>
          <div class="nav-item has-submenu">
            <a href="#" class="nav-link">
              <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/>
                <circle cx="9" cy="7" r="4"/>
                <path d="M23 21v-2a4 4 0 00-3-3.87"/>
                <path d="M16 3.13a4 4 0 010 7.75"/>
              </svg>
              <span class="nav-text">Calisanlarim</span>
              <svg class="nav-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6,9 12,15 18,9"/>
              </svg>
            </a>
            <div class="nav-submenu">
              <a href="../employees/list.html" class="nav-link"><span class="nav-text">Calisan Listesi</span></a>
              <a href="../employees/performance.html" class="nav-link"><span class="nav-text">Performans</span></a>
              <a href="../employees/tracking.html" class="nav-link"><span class="nav-text">Takip/Hakedis</span></a>
              <a href="../employees/commission.html" class="nav-link"><span class="nav-text">Komisyon Ayarlari</span></a>
            </div>
          </div>
          <div class="nav-item has-submenu">
            <a href="#" class="nav-link">
              <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/>
                <circle cx="12" cy="7" r="4"/>
              </svg>
              <span class="nav-text">Musterilerimiz</span>
              <svg class="nav-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6,9 12,15 18,9"/>
              </svg>
            </a>
            <div class="nav-submenu">
              <a href="../customers/list.html" class="nav-link"><span class="nav-text">Musteri Listesi</span></a>
              <a href="../customers/detail.html" class="nav-link"><span class="nav-text">Musteri Detay</span></a>
              <a href="../customers/renewals.html" class="nav-link"><span class="nav-text">Yenileme Takibi</span></a>
            </div>
          </div>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Finans</div>
          <div class="nav-item has-submenu">
            <a href="#" class="nav-link">
              <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="1" x2="12" y2="23"/>
                <path d="M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"/>
              </svg>
              <span class="nav-text">Finans</span>
              <svg class="nav-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6,9 12,15 18,9"/>
              </svg>
            </a>
            <div class="nav-submenu">
              <a href="../finance/dashboard.html" class="nav-link"><span class="nav-text">Finans Dashboard</span></a>
              <a href="../finance/policies.html" class="nav-link"><span class="nav-text">Police Bazli</span></a>
              <a href="../finance/collections.html" class="nav-link"><span class="nav-text">Tahsilat Takibi</span></a>
              <a href="../finance/reports.html" class="nav-link"><span class="nav-text">Raporlar</span></a>
            </div>
          </div>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Sistem</div>
          <div class="nav-item has-submenu open">
            <a href="#" class="nav-link">
              <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="3"/>
                <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/>
              </svg>
              <span class="nav-text">Ayarlar</span>
              <svg class="nav-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6,9 12,15 18,9"/>
              </svg>
            </a>
            <div class="nav-submenu">
              <a href="permissions.html" class="nav-link"><span class="nav-text">Yetki Yonetimi</span></a>
              <a href="agency-codes.html" class="nav-link"><span class="nav-text">Acente Kodlari</span></a>
              <a href="drive-integration.html" class="nav-link active"><span class="nav-text">Drive Entegrasyonu</span></a>
              <a href="report-settings.html" class="nav-link"><span class="nav-text">Rapor Ayarlari</span></a>
            </div>
          </div>
        </div>
      </nav>
      <div class="sidebar-footer">
        <button class="sidebar-toggle" onclick="document.getElementById('sidebar').classList.toggle('collapsed')">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="11,17 6,12 11,7"/>
            <polyline points="18,17 13,12 18,7"/>
          </svg>
          <span class="nav-text">Daralt</span>
        </button>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <nav class="navbar">
        <div class="navbar-left">
          <div class="navbar-breadcrumb">
            <span class="breadcrumb-item">Ayarlar</span>
            <span class="breadcrumb-separator">/</span>
            <span class="breadcrumb-item active">Drive Entegrasyonu</span>
          </div>
        </div>
        <div class="navbar-right">
          <button class="navbar-btn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9"/>
              <path d="M13.73 21a2 2 0 01-3.46 0"/>
            </svg>
            <span class="badge">3</span>
          </button>
          <div class="navbar-divider"></div>
          <div class="navbar-user">
            <div class="navbar-avatar">AY</div>
            <div class="navbar-user-info">
              <div class="navbar-user-name">Ahmet Yilmaz</div>
              <div class="navbar-user-role">Ana Yonetici</div>
            </div>
          </div>
        </div>
      </nav>

      <!-- Page Wrapper -->
      <div class="page-wrapper">
        <div class="page-content">
        <div class="page-header">
          <div>
            <h1 class="page-title">Drive Entegrasyonu</h1>
            <p class="page-subtitle">Google Drive baglantisi ve dosya senkronizasyon ayarlarini yonetin.</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-primary" id="connectDriveBtn" onclick="connectGoogleDrive()">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22.54 6.42a2.78 2.78 0 00-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 00-1.94 2A29 29 0 001 11.75a29 29 0 00.46 5.33A2.78 2.78 0 003.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 001.94-2 29 29 0 00.46-5.25 29 29 0 00-.46-5.33z"/>
                <polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"/>
              </svg>
              Drive'a Baglan
            </button>
          </div>
        </div>

        <!-- Connection Status -->
        <div class="info-alert info-alert-blue" id="connectionStatus">
          <div class="info-alert-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" y1="16" x2="12" y2="12"/>
              <line x1="12" y1="8" x2="12.01" y2="8"/>
            </svg>
          </div>
          <div class="info-alert-content">
            <p class="info-alert-title">Baglanti Durumu</p>
            <p class="info-alert-desc">Google Drive hesabiniz henuz bagli degil. Dosya senkronizasyonu icin Drive hesabinizi baglayin.</p>
          </div>
        </div>

        <!-- Stats Row -->
        <div class="stats-row">
          <div class="stat-card stat-card-mini stat-cyan">
            <div class="stat-icon">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/>
              </svg>
            </div>
            <div class="stat-content">
              <p class="stat-label">Senkronize Klasor</p>
              <h4 class="stat-value" id="syncedFolders">0</h4>
            </div>
          </div>
          <div class="stat-card stat-card-mini stat-emerald">
            <div class="stat-icon">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                <polyline points="14,2 14,8 20,8"/>
              </svg>
            </div>
            <div class="stat-content">
              <p class="stat-label">Yuklenen Dosya</p>
              <h4 class="stat-value" id="uploadedFiles">0</h4>
            </div>
          </div>
          <div class="stat-card stat-card-mini stat-amber">
            <div class="stat-icon">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="23 4 23 10 17 10"/>
                <path d="M20.49 15a9 9 0 11-2.12-9.36L23 10"/>
              </svg>
            </div>
            <div class="stat-content">
              <p class="stat-label">Son Senkronizasyon</p>
              <h4 class="stat-value" id="lastSync">-</h4>
            </div>
          </div>
          <div class="stat-card stat-card-mini stat-violet">
            <div class="stat-icon">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="2" y="2" width="20" height="8" rx="2" ry="2"/>
                <rect x="2" y="14" width="20" height="8" rx="2" ry="2"/>
                <line x1="6" y1="6" x2="6.01" y2="6"/>
                <line x1="6" y1="18" x2="6.01" y2="18"/>
              </svg>
            </div>
            <div class="stat-content">
              <p class="stat-label">Kullanilan Alan</p>
              <h4 class="stat-value" id="usedStorage">0 MB</h4>
            </div>
          </div>
        </div>

        <!-- Settings Card -->
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Senkronizasyon Ayarlari</h3>
          </div>
          <div class="card-body">
            <div class="settings-group">
              <div class="setting-item">
                <div class="setting-info">
                  <h4 class="setting-title">Otomatik Senkronizasyon</h4>
                  <p class="setting-desc">Police dosyalarini otomatik olarak Drive'a yukle</p>
                </div>
                <label class="toggle-switch">
                  <input type="checkbox" id="autoSync" checked>
                  <span class="toggle-slider"></span>
                </label>
              </div>

              <div class="setting-item">
                <div class="setting-info">
                  <h4 class="setting-title">PDF Donusumu</h4>
                  <p class="setting-desc">Dosyalari yuklemeden once PDF formatina donustur</p>
                </div>
                <label class="toggle-switch">
                  <input type="checkbox" id="convertToPdf">
                  <span class="toggle-slider"></span>
                </label>
              </div>

              <div class="setting-item">
                <div class="setting-info">
                  <h4 class="setting-title">Klasor Yapisi</h4>
                  <p class="setting-desc">Dosyalarin Drive'da nasil organize edilecegini secin</p>
                </div>
                <select class="form-select" id="folderStructure" style="width: 200px;">
                  <option value="year-month">Yil / Ay</option>
                  <option value="company">Sigorta Sirketi</option>
                  <option value="customer">Musteri</option>
                  <option value="branch">Brans</option>
                </select>
              </div>

              <div class="setting-item">
                <div class="setting-info">
                  <h4 class="setting-title">Hedef Klasor</h4>
                  <p class="setting-desc">Drive'da ana klasor yolunu belirtin</p>
                </div>
                <div style="display: flex; gap: 8px; align-items: center;">
                  <input type="text" class="form-input" id="targetFolder" value="/IHSAN AI/Policeler" style="width: 250px;">
                  <button class="btn btn-secondary btn-sm" onclick="browseFolder()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Sync History -->
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Senkronizasyon Gecmisi</h3>
            <div class="card-actions">
              <button class="btn btn-secondary btn-sm" onclick="refreshSyncHistory()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="23 4 23 10 17 10"/>
                  <path d="M20.49 15a9 9 0 11-2.12-9.36L23 10"/>
                </svg>
                Yenile
              </button>
            </div>
          </div>
          <div class="card-body" style="padding: 0;">
            <div class="table-wrapper">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Tarih</th>
                    <th>Dosya Adi</th>
                    <th>Boyut</th>
                    <th>Durum</th>
                    <th>Islem</th>
                  </tr>
                </thead>
                <tbody id="syncHistoryTable">
                  <tr>
                    <td colspan="5" class="text-center" style="padding: 40px; color: #64748b;">
                      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" style="margin: 0 auto 12px; display: block; opacity: 0.5;">
                        <path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/>
                      </svg>
                      Henuz senkronizasyon yapilmadi
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        </div>
      </div>
    </main>
  </div>

  <script src="../../assets/js/config.js"></script>
  <script src="../../assets/js/sidebar.js"></script>

  <style>
    .settings-group {
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 0;
      border-bottom: 1px solid #e2e8f0;
    }

    .setting-item:last-child {
      border-bottom: none;
    }

    .setting-info {
      flex: 1;
    }

    .setting-title {
      font-size: 14px;
      font-weight: 600;
      color: #1e293b;
      margin: 0 0 4px 0;
    }

    .setting-desc {
      font-size: 13px;
      color: #64748b;
      margin: 0;
    }

    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 48px;
      height: 24px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #cbd5e1;
      transition: 0.3s;
      border-radius: 24px;
    }

    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: 0.3s;
      border-radius: 50%;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    input:checked + .toggle-slider {
      background-color: #10b981;
    }

    input:checked + .toggle-slider:before {
      transform: translateX(24px);
    }

    .form-select {
      padding: 8px 12px;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      font-size: 14px;
      color: #1e293b;
      background: white;
      cursor: pointer;
    }

    .form-select:focus {
      outline: none;
      border-color: #6366f1;
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }

    .form-input {
      padding: 8px 12px;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      font-size: 14px;
      color: #1e293b;
    }

    .form-input:focus {
      outline: none;
      border-color: #6366f1;
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }

    .btn-sm {
      padding: 6px 12px;
      font-size: 13px;
    }

    .info-alert-blue {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(59, 130, 246, 0.05) 100%);
      border-left: 4px solid #3b82f6;
    }

    .info-alert-blue .info-alert-icon {
      color: #3b82f6;
    }

    .info-alert-green {
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(16, 185, 129, 0.05) 100%);
      border-left: 4px solid #10b981;
    }

    .info-alert-green .info-alert-icon {
      color: #10b981;
    }
  </style>

  <script>
    // Yetki kontrolu
    document.addEventListener('DOMContentLoaded', function() {
      if (!requireAuth()) return;
      if (!requirePermission('driveEntegrasyonuGorebilsin', '../../index.html')) return;

      // Baglanti durumunu kontrol et
      checkConnectionStatus();
    });

    // Google Drive baglantisi
    async function connectGoogleDrive() {
      showToast('Google Drive entegrasyonu yaklinda...', 'info');
    }

    // Baglanti durumunu kontrol et
    async function checkConnectionStatus() {
      // API'den baglanti durumunu cek
      // Simdilik placeholder
    }

    // Klasor secimi
    function browseFolder() {
      showToast('Klasor secimi yaklinda...', 'info');
    }

    // Senkronizasyon gecmisini yenile
    function refreshSyncHistory() {
      showToast('Gecmis yenileniyor...', 'info');
    }
  </script>
</body>
</html>
