<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Yenileme Takibi - IHSAN AI</title>
  <link rel="stylesheet" href="../../assets/css/main.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
  <div class="gradient-mesh"></div>
  <div class="app-container">
    <aside class="sidebar" id="sidebar"></aside>

    <main class="main-content">
      <nav class="navbar">
        <div class="navbar-left">
          <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Menu">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </button>
          <div class="navbar-breadcrumb">
            <span class="breadcrumb-item">Müşterilerimiz</span>
            <span class="breadcrumb-separator">/</span>
            <span class="breadcrumb-item active">Yenileme Takibi</span>
          </div>
        </div>
        <div class="navbar-right">
          <button class="navbar-btn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9"/>
              <path d="M13.73 21a2 2 0 01-3.46 0"/>
            </svg>
            <span class="badge">3</span>
          </button>
          <div class="navbar-divider"></div>
          <div class="navbar-user">
            <div class="navbar-avatar"></div>
            <div class="navbar-user-info">
              <div class="navbar-user-name">Yükleniyor...</div>
              <div class="navbar-user-role"></div>
            </div>
          </div>
        </div>
      </nav>

      <div class="page-wrapper">
        <div class="page-content rn-page">

          <!-- ====== Header ====== -->
          <div class="rn-header">
            <div class="rn-header-left">
              <h1 class="rn-title">Yenileme Takibi</h1>
              <p class="rn-subtitle">Yaklaşan poliçe yenilemelerini takip edin ve müşterilerinize ulaşın</p>
            </div>
            <div class="rn-header-actions">
              <span class="rn-connection-indicator" id="sseIndicator">
                <span class="rn-connection-dot" id="sseConnectionDot"></span>
                <span id="sseConnectionText">Baglanti bekleniyor</span>
              </span>
              <button class="rn-btn rn-btn--outline" id="btnExcelExport">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                  <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
                  <polyline points="7,10 12,15 17,10"/>
                  <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                Excel
              </button>
              <button class="rn-btn rn-btn--primary" id="btnBulkAutoQuote">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                  <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
                </svg>
                Toplu Teklif
              </button>
            </div>
          </div>

          <!-- ====== Stat Cards Row (replaces urgency chips) ====== -->
          <div class="rn-stats-row">
            <div class="rn-stat-card" id="statCardCritical" data-filter="7">
              <div class="stat-icon" style="background:var(--danger-glow);color:var(--danger);">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="22" height="22">
                  <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/>
                  <line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/>
                </svg>
              </div>
              <div>
                <div class="stat-card-value" id="statCount7">0</div>
                <div class="stat-card-label">Kritik (&le;7 gün)</div>
              </div>
            </div>
            <div class="rn-stat-card" id="statCardWarning" data-filter="15">
              <div class="stat-icon" style="background:var(--warning-glow);color:var(--warning);">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="22" height="22">
                  <circle cx="12" cy="12" r="10"/><polyline points="12,6 12,12 16,14"/>
                </svg>
              </div>
              <div>
                <div class="stat-card-value" id="statCount15">0</div>
                <div class="stat-card-label">Yaklaşan (&le;15 gün)</div>
              </div>
            </div>
            <div class="rn-stat-card" id="statCard30" data-filter="30">
              <div class="stat-icon" style="background:var(--info-glow);color:var(--info);">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="22" height="22">
                  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/>
                </svg>
              </div>
              <div>
                <div class="stat-card-value" id="statCount30">0</div>
                <div class="stat-card-label">30 Gün İçinde</div>
              </div>
            </div>
            <div class="rn-stat-card" id="statCardRevenue" data-filter="all">
              <div class="stat-icon" style="background:var(--success-glow);color:var(--success);">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="22" height="22">
                  <line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"/>
                </svg>
              </div>
              <div>
                <div class="stat-card-value" id="statRevenue">0 TL</div>
                <div class="stat-card-label">Potansiyel Prim</div>
              </div>
            </div>
          </div>

          <!-- ====== Compact Toolbar: filters + status tabs inline ====== -->
          <div class="rn-toolbar" id="renewalToolbar">
            <div class="rn-toolbar-row">
              <!-- Search -->
              <div class="rn-search-wrap">
                <svg class="rn-search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="15" height="15">
                  <circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/>
                </svg>
                <input type="text" id="searchInput" placeholder="Müşteri, plaka, poliçe no..." class="rn-search">
              </div>

              <!-- Dropdowns -->
              <select id="filterCompany" class="rn-select"><option value="">Tüm Şirketler</option></select>
              <select id="filterType" class="rn-select"><option value="">Tüm Türler</option></select>
              <select id="sortBy" class="rn-select">
                <option value="BitisTarihi_asc">Bitiş &#8593;</option>
                <option value="BitisTarihi_desc">Bitiş &#8595;</option>
                <option value="BrutPrim_desc">Prim &#8595;</option>
                <option value="BrutPrim_asc">Prim &#8593;</option>
              </select>
              <button class="rn-reset-btn" id="btnResetFilters" title="Filtreleri Sıfırla">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="15" height="15">
                  <polyline points="1,4 1,10 7,10"/><path d="M3.51 15a9 9 0 102.13-9.36L1 10"/>
                </svg>
              </button>

              <!-- Phone popover trigger -->
              <button class="rn-btn rn-btn--outline rn-phone-trigger" id="phonePopoverBtn" title="Telefon numarası">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                  <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72c.127.96.361 1.903.7 2.81a2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0122 16.92z"/>
                </svg>
              </button>
              <div class="rn-phone-popover" id="phonePopover" style="display:none;">
                <label class="rn-phone-popover-label">Tekliflerin geleceği telefon:</label>
                <input type="tel" id="quotePhoneNumber" class="rn-phone-input" placeholder="5XX XXX XX XX" maxlength="11">
                <span class="rn-phone-status" id="phoneStatus"></span>
              </div>

              <!-- Separator -->
              <div class="rn-toolbar-sep"></div>

              <!-- Status tabs (inline) -->
              <div class="rn-status-tabs" id="statusTabs">
                <button class="rn-status-tab active" data-status="active"><span class="tab-dot"></span>Tümü <span class="tab-count" id="tabCountActive">0</span></button>
                <button class="rn-status-tab" data-status="0"><span class="tab-dot"></span>Bekliyor <span class="tab-count" id="tabCount0">0</span></button>
                <button class="rn-status-tab" data-status="2"><span class="tab-dot"></span>Teklif Alındı <span class="tab-count" id="tabCount2">0</span></button>
                <button class="rn-status-tab" data-status="3"><span class="tab-dot"></span>İletildi <span class="tab-count" id="tabCount3">0</span></button>
                <button class="rn-status-tab" data-status="completed"><span class="tab-dot"></span>Tamamlanan <span class="tab-count" id="tabCountCompleted">0</span></button>
              </div>
            </div>
          </div>

          <!-- ====== Split Panel Layout ====== -->
          <div class="rn-split">

            <!-- LEFT: Table (60%) -->
            <div class="rn-split-left">

              <!-- Selection Bar (hidden by default) -->
              <div class="rn-selection-bar" id="selectionBar" style="display:none">
                <span><strong id="selCount">0</strong> poliçe seçildi</span>
                <div class="rn-selection-actions">
                  <button id="btnSelectAllVisible">Tümünü Seç</button>
                  <button id="btnClearSelection">Temizle</button>
                  <button id="btnBatchWizard">Toplu Teklif Al</button>
                  <select id="batchStateSelect" class="rn-state-select">
                    <option value="">Durum Değiştir...</option>
                    <option value="0">Bekliyor</option>
                    <option value="2">Teklif Alındı</option>
                    <option value="3">Müşteriye İletildi</option>
                    <option value="4">Poliçeleşti</option>
                    <option value="5">Reddetti</option>
                  </select>
                </div>
              </div>

              <div class="rn-table-wrap">
                <div class="rn-table-info">
                  <span class="rn-result-count"><strong id="tableResultCount">0</strong> poliçe</span>
                </div>

                <div class="rn-table-scroll">
                  <table class="rn-table">
                    <thead>
                      <tr>
                        <th class="rn-th--urgency"></th>
                        <th class="rn-th--checkbox"><input type="checkbox" id="selectAllCheckbox" class="rn-checkbox" title="Tümünü Seç"></th>
                        <th class="rn-th--days">Kalan</th>
                        <th class="rn-th--customer">Müşteri</th>
                        <th class="rn-th--type">Tür</th>
                        <th class="rn-th--plate">Plaka / No</th>
                        <th class="rn-th--company">Şirket</th>
                        <th class="rn-th--date">Bitiş</th>
                        <th class="rn-th--premium">Prim</th>
                        <th class="rn-th--actions">İşlem</th>
                      </tr>
                    </thead>
                    <tbody id="policiesBody">
                      <tr>
                        <td colspan="10">
                          <div class="rn-loading">
                            <div class="rn-spinner"></div>
                            <span>Poliçeler yükleniyor...</span>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                <!-- Pagination -->
                <div class="rn-pagination" id="paginationContainer" style="display:none;">
                  <div class="rn-pagination-info" id="paginationInfo"></div>
                  <div class="rn-pagination-controls" id="paginationControls"></div>
                </div>
              </div>
            </div>

            <!-- RIGHT: Detail / Wizard Panel (40%) -->
            <div class="rn-split-right" id="rightPanel">
              <!-- Placeholder -->
              <div class="rn-panel-placeholder" id="panelPlaceholder">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="48" height="48">
                  <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                  <polyline points="14,2 14,8 20,8"/>
                  <line x1="16" y1="13" x2="8" y2="13"/>
                  <line x1="16" y1="17" x2="8" y2="17"/>
                  <polyline points="10,9 9,9 8,9"/>
                </svg>
                <h3>Poliçe Seçin</h3>
                <p>Detaylarını görmek için tablodaki bir poliçeye tıklayın veya checkbox ile seçim yaparak toplu teklif alın.</p>
              </div>

              <!-- Detail Panel (hidden, populated by JS) -->
              <div id="panelDetail" style="display:none"></div>

              <!-- Wizard Panel (hidden) -->
              <div class="rn-panel-wizard" id="panelWizard" style="display:none">
                <!-- Mini step indicator -->
                <div class="rn-wiz-steps" id="wizStepIndicator">
                  <div class="rn-wiz-step active" data-step="review">
                    <span class="rn-wiz-num">1</span>
                    <span class="rn-wiz-label">Kontrol</span>
                  </div>
                  <div class="rn-wiz-connector"></div>
                  <div class="rn-wiz-step" data-step="send">
                    <span class="rn-wiz-num">2</span>
                    <span class="rn-wiz-label">Gönder</span>
                  </div>
                  <div class="rn-wiz-connector"></div>
                  <div class="rn-wiz-step" data-step="track">
                    <span class="rn-wiz-num">3</span>
                    <span class="rn-wiz-label">Takip</span>
                  </div>
                </div>
                <!-- Step panels -->
                <div class="rn-wiz-panel active" id="wizReview"></div>
                <div class="rn-wiz-panel" id="wizSend"></div>
                <div class="rn-wiz-panel" id="wizTrack"></div>
                <!-- Footer -->
                <div class="rn-wiz-footer">
                  <button class="rn-btn rn-btn--outline" id="wizBtnBack" disabled>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
                    Geri
                  </button>
                  <button class="rn-btn rn-btn--primary" id="wizBtnNext">
                    İleri
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
                  </button>
                </div>
              </div>
            </div>

          </div>

          <!-- ====== Sorgu Gecmisi (collapsible) ====== -->
          <details class="rn-history-section" id="quoteHistorySection">
            <summary class="rn-history-header">
              <div class="rn-history-header-left">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                  <circle cx="12" cy="12" r="10"/><polyline points="12,6 12,12 16,14"/>
                </svg>
                <h3 class="rn-history-title">Sorgu Gecmisi</h3>
                <span class="rn-history-badge" id="historyCount">0</span>
              </div>
              <button class="rn-btn rn-btn--outline rn-btn--sm" id="btnRefreshHistory" onclick="event.preventDefault();loadQuoteHistory()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                  <polyline points="1,4 1,10 7,10"/><path d="M3.51 15a9 9 0 102.13-9.36L1 10"/>
                </svg>
                Yenile
              </button>
            </summary>
            <div id="historyTableWrap">
              <div class="rn-history-empty"><span>Sorgu gecmisi yuklenecek...</span></div>
            </div>
          </details>

          <!-- ====== Dev Test Panel (hidden by default, shown with ?dev=1) ====== -->
          <div class="test-panel" id="testPanel" style="display: none;">
            <div class="test-panel-header" onclick="toggleTestPanel()">
              <div class="test-panel-title">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                  <path d="M14.7 6.3a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l3.77-3.77a6 6 0 01-7.94 7.94l-6.91 6.91a2.12 2.12 0 01-3-3l6.91-6.91a6 6 0 017.94-7.94l-3.76 3.76z"/>
                </svg>
                Dev: Manuel Teklif Test
              </div>
              <svg class="test-panel-chevron" id="testPanelChevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                <polyline points="6,9 12,15 18,9"/>
              </svg>
            </div>
            <div class="test-panel-body" id="testPanelBody" style="display: none;">
              <p class="test-panel-desc">Teklif türü seçin, gerekli bilgileri doldurun ve test edin.</p>
              <div class="test-form-grid">
                <div class="modal-field">
                  <label class="modal-label">Teklif Türü *</label>
                  <select id="testQuoteType" class="modal-select" onchange="onTestQuoteTypeChange()">
                    <option value="traffic">Trafik</option>
                    <option value="casco">Kasko</option>
                    <option value="imm">İMM</option>
                    <option value="dask">DASK</option>
                    <option value="house">Konut</option>
                    <option value="tss">TSS (Sağlık)</option>
                  </select>
                </div>
                <div class="modal-field">
                  <label class="modal-label">TC Kimlik No *</label>
                  <input type="text" id="testTcKimlikNo" class="modal-input" placeholder="11 haneli TC" maxlength="11" inputmode="numeric">
                </div>
                <div class="modal-field">
                  <label class="modal-label">Telefon</label>
                  <input type="text" id="testTelefon" class="modal-input" placeholder="5xxxxxxxxx" maxlength="10" inputmode="numeric">
                </div>
              </div>
              <div id="testVehicleFields">
                <div class="test-section-label">Araç Bilgileri</div>
                <div class="test-form-grid">
                  <div class="modal-field">
                    <label class="modal-label">Plaka *</label>
                    <input type="text" id="testPlaka" class="modal-input" placeholder="34ABC123" style="text-transform: uppercase;">
                  </div>
                </div>
              </div>
              <div id="testTssFields" style="display: none;">
                <div class="test-section-label">Sağlık (TSS) Bilgileri</div>
                <div class="test-form-grid">
                  <div class="modal-field">
                    <label class="modal-label">Sigortalı Adı *</label>
                    <input type="text" id="testSigortaliAdi" class="modal-input" placeholder="Ad Soyad">
                  </div>
                  <div class="modal-field">
                    <label class="modal-label">Doğum Tarihi *</label>
                    <input type="date" id="testTssDogumTarihi" class="modal-input">
                  </div>
                  <div class="modal-field">
                    <label class="modal-label">Boy (cm)</label>
                    <input type="number" id="testTssBoy" class="modal-input" placeholder="175">
                  </div>
                  <div class="modal-field">
                    <label class="modal-label">Kilo (kg)</label>
                    <input type="number" id="testTssKilo" class="modal-input" placeholder="80">
                  </div>
                  <div class="modal-field">
                    <label class="modal-label">Ağ Tipi</label>
                    <select id="testTssAgTipi" class="modal-select">
                      <option value="">Seçiniz</option>
                      <option value="0">Eko Paket</option>
                      <option value="1">Geniş Paket</option>
                      <option value="2">Eko+Geniş</option>
                    </select>
                  </div>
                  <div class="modal-field">
                    <label class="modal-label">Plan Tipi</label>
                    <select id="testTssPlanTipi" class="modal-select">
                      <option value="">Seçiniz</option>
                      <option value="0">5 Adet Ayakta</option>
                      <option value="1">10 Adet Ayakta</option>
                      <option value="2">Karma</option>
                      <option value="3">Maksimum Adet</option>
                    </select>
                  </div>
                  <div class="modal-field" style="display:flex;align-items:center;gap:0.5rem;padding-top:1.5rem;">
                    <input type="checkbox" id="testTssDogumTeminati" style="width:16px;height:16px;accent-color:var(--primary);">
                    <label class="modal-label" for="testTssDogumTeminati" style="margin:0;cursor:pointer;">Doğum Teminatı</label>
                  </div>
                </div>
              </div>
              <div id="testDaskFields" style="display: none;">
                <div class="test-section-label">DASK Bilgileri</div>
                <div class="test-form-grid">
                  <div class="modal-field" style="grid-column:1/-1;"><label class="modal-label">Bina Adresi</label><input type="text" id="testDaskBinaAdresi" class="modal-input" placeholder="Bina adresi"></div>
                  <div class="modal-field"><label class="modal-label">UAVT Kodu</label><input type="text" id="testDaskUAVTKodu" class="modal-input" placeholder="UAVT"></div>
                  <div class="modal-field"><label class="modal-label">Brüt m²</label><input type="number" id="testDaskBrutM2" class="modal-input" placeholder="120"></div>
                  <div class="modal-field"><label class="modal-label">İnşaat Yılı</label><input type="number" id="testDaskInsaatYili" class="modal-input" placeholder="2005"></div>
                  <div class="modal-field"><label class="modal-label">Toplam Kat</label><input type="number" id="testDaskToplamKat" class="modal-input" placeholder="5"></div>
                  <div class="modal-field"><label class="modal-label">Bulunduğu Kat</label><input type="number" id="testDaskBulunduguKat" class="modal-input" placeholder="3"></div>
                  <div class="modal-field"><label class="modal-label">Yapı Tarzı</label><select id="testDaskYapiTarzi" class="modal-select"><option value="">Seçiniz</option><option value="1">Çelik/Betonarme</option><option value="2">Diğer</option></select></div>
                  <div class="modal-field"><label class="modal-label">Kullanım</label><select id="testDaskKullanimSekli" class="modal-select"><option value="">Seçiniz</option><option value="1">Mesken</option><option value="2">İşyeri</option></select></div>
                  <div class="modal-field"><label class="modal-label">Mevcut Poliçe No</label><input type="text" id="testDaskMevcutPoliceNo" class="modal-input"></div>
                </div>
              </div>
              <div id="testHouseFields" style="display: none;">
                <div class="test-section-label">Konut Bilgileri</div>
                <div class="test-form-grid">
                  <div class="modal-field" style="grid-column:1/-1;"><label class="modal-label">Bina Adresi</label><input type="text" id="testHouseBinaAdresi" class="modal-input" placeholder="Bina adresi"></div>
                  <div class="modal-field"><label class="modal-label">UAVT Kodu</label><input type="text" id="testHouseUAVTKodu" class="modal-input"></div>
                  <div class="modal-field"><label class="modal-label">Brüt m²</label><input type="number" id="testHouseBrutM2" class="modal-input" placeholder="120"></div>
                  <div class="modal-field"><label class="modal-label">İnşaat Yılı</label><input type="number" id="testHouseInsaatYili" class="modal-input" placeholder="2005"></div>
                  <div class="modal-field"><label class="modal-label">Toplam Kat</label><input type="number" id="testHouseToplamKat" class="modal-input" placeholder="5"></div>
                  <div class="modal-field"><label class="modal-label">Bulunduğu Kat</label><input type="number" id="testHouseBulunduguKat" class="modal-input" placeholder="3"></div>
                  <div class="modal-field"><label class="modal-label">Yapı Tarzı</label><select id="testHouseYapiTarzi" class="modal-select"><option value="">Seçiniz</option><option value="1">Çelik/Betonarme</option><option value="2">Diğer</option></select></div>
                  <div class="modal-field"><label class="modal-label">Bina Beyan Değeri</label><input type="number" id="testHouseBinaBeyanDegeri" class="modal-input" placeholder="500000"></div>
                  <div class="modal-field"><label class="modal-label">Eşya Beyan Değeri</label><input type="number" id="testHouseEsyaBeyanDegeri" class="modal-input" placeholder="100000"></div>
                </div>
              </div>
              <div id="testLogContainer" style="display: none;">
                <div class="test-section-label">Sonuç Logu</div>
                <div class="test-log" id="testLog"></div>
              </div>
              <div class="test-panel-actions">
                <button class="rn-btn rn-btn--primary" id="btnTestQuote" onclick="submitTestQuote()">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14"><polygon points="5,3 19,12 5,21 5,3"/></svg>
                  Test Gönder
                </button>
                <button class="rn-btn rn-btn--outline" onclick="clearTestLog()">Logu Temizle</button>
              </div>
            </div>
          </div>

        </div>
      </div>
    </main>
  </div>

  <!-- ====== TC Kimlik Atama Modal ====== -->
  <div class="modal" id="tcAssignModal">
    <div class="modal-overlay"></div>
    <div class="modal-content" style="max-width: 480px;">
      <div class="modal-header">
        <div>
          <h3>TC Kimlik Bilgisi Gerekli</h3>
          <p id="tcAssignSubtitle" style="font-size:0.8125rem;color:var(--text-secondary);margin:0.25rem 0 0 0;"></p>
        </div>
        <button class="modal-close" onclick="closeTcAssignModal()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="tc-assign-info">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:18px;height:18px;flex-shrink:0;color:var(--warning);">
            <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/>
            <line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/>
          </svg>
          <span>Teklif çalıştırmak için TC Kimlik No veya Vergi No gereklidir.</span>
        </div>
        <div class="modal-field" style="margin-top:1.25rem;">
          <label class="modal-label">TC Kimlik No</label>
          <input type="text" id="tcAssignInput" class="modal-input" placeholder="11 haneli TC Kimlik No" maxlength="11" inputmode="numeric">
        </div>
        <div class="tc-assign-divider"><span>veya</span></div>
        <div class="modal-field">
          <label class="modal-label">Vergi No</label>
          <input type="text" id="vknAssignInput" class="modal-input" placeholder="10 haneli Vergi No" maxlength="10" inputmode="numeric">
        </div>
        <div id="tcAssignCustomerLink" class="tc-assign-customer-link" style="display:none;">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px;flex-shrink:0;"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
          <span>Bu poliçenin müşteri kartı mevcut.</span>
          <a id="tcAssignCustomerDetailLink" href="#" target="_blank">Müşteri Kartını Aç</a>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-modal btn-outline" onclick="closeTcAssignModal()">İptal</button>
        <button class="btn-modal btn-primary" id="btnSaveAndQuote" onclick="saveAndQuote()">Kaydet ve Teklif Çalış</button>
      </div>
    </div>
  </div>

  <!-- ====== Eksik Bilgi Modal (Araç bazlı teklifler) ====== -->
  <div class="modal" id="missingInfoModal">
    <div class="modal-overlay"></div>
    <div class="modal-content" style="max-width: 480px;">
      <div class="modal-header">
        <div>
          <h3>Eksik Bilgiler</h3>
          <p id="missingInfoSubtitle" style="font-size:0.8125rem;color:var(--text-secondary);margin:0.25rem 0 0 0;"></p>
        </div>
        <button class="modal-close" onclick="closeMissingInfoModal()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="tc-assign-info">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:18px;height:18px;flex-shrink:0;color:var(--info);">
            <circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/>
          </svg>
          <span>Teklif için bazı bilgiler eksik. Doldurup devam edebilir veya eksik bilgilerle teklif alabilirsiniz.</span>
        </div>
        <div id="missingInfoFields"></div>
      </div>
      <div class="modal-footer">
        <button class="btn-modal btn-outline" onclick="closeMissingInfoModal()">Iptal</button>
        <button class="btn-modal btn-outline" id="btnSkipMissing" onclick="submitWithMissingInfo(false)">Eksik Bilgilerle Devam Et</button>
        <button class="btn-modal btn-primary" id="btnSaveMissing" onclick="submitWithMissingInfo(true)">Kaydet ve Teklif Calis</button>
      </div>
    </div>
  </div>

  <!-- ====== DASK/Konut Extra Info Modal ====== -->
  <div class="modal" id="daskHouseFormModal">
    <div class="modal-overlay"></div>
    <div class="modal-content" style="max-width:640px;">
      <div class="modal-header">
        <h3 id="daskHouseFormTitle">Ek Bilgiler</h3>
        <button class="modal-close" onclick="closeDaskHouseForm()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <div class="modal-body">
        <p class="modal-description">Teklif oluşturmak için ek bina bilgilerini girin</p>
        <div class="form-grid">
          <div class="modal-field"><label class="modal-label">Bina Adresi</label><input type="text" id="daskBinaAdresi" class="modal-input" placeholder="Atatürk Mah. Cumhuriyet Cad. No:1"></div>
          <div class="modal-field"><label class="modal-label">UAVT Kodu</label><input type="text" id="daskUAVTKodu" class="modal-input" placeholder="UAVT adres kodu"></div>
          <div class="modal-field half"><label class="modal-label">Brüt m²</label><input type="number" id="daskBrutM2" class="modal-input" placeholder="120"></div>
          <div class="modal-field half"><label class="modal-label">İnşaat Yılı</label><input type="number" id="daskInsaatYili" class="modal-input" placeholder="2005"></div>
          <div class="modal-field half"><label class="modal-label">Toplam Kat Sayısı</label><input type="number" id="daskToplamKat" class="modal-input" placeholder="5"></div>
          <div class="modal-field half"><label class="modal-label">Bulunduğu Kat</label><input type="number" id="daskBulunduguKat" class="modal-input" placeholder="3"></div>
          <div class="modal-field half"><label class="modal-label">Yapı Tarzı</label><select id="daskYapiTarzi" class="modal-select"><option value="">Seçiniz</option><option value="1">Çelik / Betonarme</option><option value="2">Diğer</option></select></div>
          <div class="modal-field half" id="daskKullanimSekliField"><label class="modal-label">Kullanım Şekli</label><select id="daskKullanimSekli" class="modal-select"><option value="">Seçiniz</option><option value="1">Mesken</option><option value="2">İşyeri</option></select></div>
          <div class="modal-field half" id="daskPoliceNoField"><label class="modal-label">Mevcut DASK Poliçe No</label><input type="text" id="daskMevcutPoliceNo" class="modal-input"></div>
          <div class="modal-field half konut-only" style="display:none;"><label class="modal-label">Bina Beyan Değeri (TL)</label><input type="number" id="daskBinaBeyanDegeri" class="modal-input" placeholder="500000"></div>
          <div class="modal-field half konut-only" style="display:none;"><label class="modal-label">Eşya Beyan Değeri (TL)</label><input type="number" id="daskEsyaBeyanDegeri" class="modal-input" placeholder="100000"></div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-modal btn-outline" onclick="closeDaskHouseForm()">İptal</button>
        <button class="btn-modal btn-primary" id="btnSubmitDaskHouse" onclick="submitDaskHouseQuote()">Teklif Çalış</button>
      </div>
    </div>
  </div>

  <!-- ====== TSS Extra Info Modal ====== -->
  <div class="modal" id="tssFormModal">
    <div class="modal-overlay"></div>
    <div class="modal-content" style="max-width:560px;">
      <div class="modal-header">
        <h3>Sağlık Sigortası - Ek Bilgiler</h3>
        <button class="modal-close" onclick="closeTssForm()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <div class="modal-body">
        <p class="modal-description">TSS teklifi için sağlık bilgilerini girin</p>
        <div class="form-grid">
          <div class="modal-field full"><label class="modal-label">Doğum Tarihi <span style="color:var(--danger);">*</span></label><input type="date" id="tssDogumTarihi" class="modal-input" required></div>
          <div class="modal-field half"><label class="modal-label">Boy (cm)</label><input type="number" id="tssBoy" class="modal-input" placeholder="175"></div>
          <div class="modal-field half"><label class="modal-label">Kilo (kg)</label><input type="number" id="tssKilo" class="modal-input" placeholder="80"></div>
          <div class="modal-field half"><label class="modal-label">Ağ Tipi</label><select id="tssAgTipi" class="modal-select"><option value="">Seçiniz</option><option value="0">Eko Paket</option><option value="1">Geniş Paket</option><option value="2">Eko+Geniş</option></select></div>
          <div class="modal-field half"><label class="modal-label">Plan Tipi</label><select id="tssPlanTipi" class="modal-select"><option value="">Seçiniz</option><option value="0">5 Adet Ayakta</option><option value="1">10 Adet Ayakta</option><option value="2">Karma</option><option value="3">Maksimum Adet</option></select></div>
          <div class="modal-field full"><label class="modal-label" style="display:flex;align-items:center;gap:0.5rem;cursor:pointer;"><input type="checkbox" id="tssDogumTeminati" style="width:16px;height:16px;accent-color:var(--primary);"> Doğum Teminatı</label></div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-modal btn-outline" onclick="closeTssForm()">İptal</button>
        <button class="btn-modal btn-primary" onclick="submitTssQuote()">Teklif Çalış</button>
      </div>
    </div>
  </div>

  <script src="../../assets/js/config.js"></script>
  <script src="../../assets/js/app.js"></script>
  <script src="../../components/base.js"></script>
  <script src="../../components/toast.js"></script>
  <script src="../../components/modal.js"></script>
  <script src="../../components/sidebar.js"></script>

  <style>
    /* ===================================================================
       YENILEME TAKIBI  --  Page-specific styles (.rn- prefix)
       Reduced from ~1500 lines to ~580 lines by reusing components.css
       =================================================================== */

    .rn-page { max-width: 1800px; margin: 0 auto; }

    /* --- Header -------------------------------------------------------- */
    .rn-header {
      display: flex; justify-content: space-between; align-items: flex-start;
      gap: 1.5rem; margin-bottom: 1rem;
    }
    .rn-title {
      font-size: 1.75rem; font-weight: 700; margin: 0 0 0.25rem 0;
      color: var(--text-primary); letter-spacing: -0.025em;
    }
    .rn-subtitle { font-size: 0.875rem; color: var(--text-muted); margin: 0; }
    .rn-header-actions { display: flex; gap: 0.5rem; flex-shrink: 0; align-items: center; }

    /* --- Buttons (.rn-btn) --------------------------------------------- */
    .rn-btn {
      display: inline-flex; align-items: center; gap: 0.375rem;
      padding: 0.5rem 0.875rem; border-radius: var(--radius-sm);
      font-size: 0.8125rem; font-weight: 600; cursor: pointer;
      border: 1.5px solid transparent; transition: all var(--transition-fast);
      white-space: nowrap; font-family: var(--font-sans);
    }
    .rn-btn--outline {
      background: transparent; color: var(--text-secondary); border-color: var(--border-default);
    }
    .rn-btn--outline:hover {
      background: var(--bg-elevated); border-color: var(--border-strong); color: var(--text-primary);
    }
    .rn-btn--primary { background: var(--primary); color: white; border-color: var(--primary); }
    .rn-btn--primary:hover { background: var(--primary-dim); box-shadow: 0 4px 12px var(--primary-glow); }
    .rn-btn--sm { padding: 0.3125rem 0.625rem; font-size: 0.75rem; }

    /* --- Stat Cards Row ------------------------------------------------ */
    .rn-stats-row {
      display: grid; grid-template-columns: repeat(4, 1fr);
      gap: 0.75rem; margin-bottom: 1rem;
    }
    .rn-stat-card {
      cursor: pointer; display: flex; align-items: center; gap: 0.75rem;
      padding: 1rem; background: var(--bg-surface);
      border: 1.5px solid var(--border-subtle); border-radius: var(--radius-lg);
      transition: all var(--transition-base); box-shadow: var(--card-shadow);
    }
    .rn-stat-card:hover {
      border-color: var(--border-default); transform: translateY(-1px);
      box-shadow: var(--card-shadow-hover);
    }
    .rn-stat-card--active {
      border-color: var(--primary) !important;
      box-shadow: 0 0 0 3px var(--primary-glow);
    }

    /* --- Toolbar ------------------------------------------------------- */
    .rn-toolbar {
      background: var(--bg-surface); border: 1.5px solid var(--border-default);
      border-radius: var(--radius-md); padding: 0.625rem 1rem; margin-bottom: 1rem;
      position: sticky; top: var(--navbar-height); z-index: 20;
      backdrop-filter: blur(12px);
    }
    .rn-toolbar-row { display: flex; align-items: center; gap: 0.625rem; flex-wrap: wrap; }
    .rn-toolbar-sep { width: 1px; height: 24px; background: var(--border-default); flex-shrink: 0; }

    /* Search */
    .rn-search-wrap { position: relative; flex: 1; min-width: 160px; max-width: 260px; }
    .rn-search-icon {
      position: absolute; left: 0.625rem; top: 50%; transform: translateY(-50%);
      color: var(--text-dim); pointer-events: none;
    }
    .rn-search {
      width: 100%; padding: 0.4375rem 0.625rem 0.4375rem 2rem;
      background: var(--bg-base); border: 1.5px solid var(--border-default);
      border-radius: var(--radius-sm); color: var(--text-primary);
      font-size: 0.8125rem; transition: border-color var(--transition-fast);
    }
    .rn-search:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px var(--primary-glow); }
    .rn-search::placeholder { color: var(--text-dim); }

    /* Dropdowns */
    .rn-select {
      padding: 0.4375rem 0.5rem; background: var(--bg-base);
      border: 1.5px solid var(--border-default); border-radius: var(--radius-sm);
      color: var(--text-primary); font-size: 0.8125rem; cursor: pointer; min-width: 100px;
    }
    .rn-select:focus { outline: none; border-color: var(--primary); }

    /* Reset button */
    .rn-reset-btn {
      padding: 0.4375rem; background: transparent;
      border: 1.5px solid var(--border-default); border-radius: var(--radius-sm);
      color: var(--text-dim); cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      transition: all var(--transition-fast);
    }
    .rn-reset-btn:hover { background: var(--bg-elevated); color: var(--text-primary); border-color: var(--border-strong); }

    /* --- Phone Popover ------------------------------------------------- */
    .rn-phone-trigger { padding: 0.4375rem 0.5rem; }
    .rn-phone-popover {
      position: absolute; top: calc(100% + 0.5rem); right: 0;
      background: var(--bg-surface); border: 1.5px solid var(--border-default);
      border-radius: var(--radius-md); padding: 0.75rem 1rem;
      box-shadow: var(--shadow-lg); z-index: 30; min-width: 280px;
      display: flex; align-items: center; gap: 0.5rem;
    }
    .rn-phone-popover-label { font-size: 0.75rem; color: var(--text-secondary); white-space: nowrap; }
    .rn-phone-input {
      background: var(--bg-base); border: 1px solid var(--border-default);
      border-radius: var(--radius-sm); color: var(--text-primary);
      font-family: 'JetBrains Mono', var(--font-mono), monospace;
      font-size: 0.85rem; font-weight: 600; padding: 0.35rem 0.6rem;
      width: 130px; letter-spacing: 0.5px;
    }
    .rn-phone-input:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 2px var(--primary-glow); }
    .rn-phone-status { font-size: 0.75rem; color: var(--text-dim); }

    /* --- Status Tabs (inline in toolbar) ------------------------------- */
    .rn-status-tabs {
      display: flex; gap: 0; background: var(--bg-elevated);
      border-radius: var(--radius-md); border: 1px solid var(--border-subtle);
      padding: 3px; overflow: hidden; flex-shrink: 0;
    }
    .rn-status-tab {
      display: flex; align-items: center; justify-content: center; gap: 5px;
      padding: 0.375rem 0.5rem; border-radius: var(--radius-sm);
      font-size: 0.6875rem; font-weight: 600; cursor: pointer; border: none;
      background: transparent; color: var(--text-dim); transition: all 0.2s;
      white-space: nowrap;
    }
    .rn-status-tab:hover { color: var(--text-primary); background: rgba(255,255,255,0.04); }
    .rn-status-tab.active {
      background: var(--bg-surface); color: var(--text-primary);
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .rn-status-tab .tab-dot { width: 7px; height: 7px; border-radius: 50%; flex-shrink: 0; }
    .rn-status-tab[data-status="active"] .tab-dot  { background: var(--primary); }
    .rn-status-tab[data-status="0"] .tab-dot       { background: var(--warning); }
    .rn-status-tab[data-status="2"] .tab-dot       { background: #2563eb; }
    .rn-status-tab[data-status="3"] .tab-dot       { background: #4f46e5; }
    .rn-status-tab[data-status="completed"] .tab-dot { background: var(--success); }
    .rn-status-tab .tab-count {
      display: inline-flex; align-items: center; justify-content: center;
      min-width: 18px; height: 16px; padding: 0 4px; border-radius: 8px;
      font-size: 0.5625rem; font-weight: 700;
      background: rgba(0,0,0,0.06); color: var(--text-dim);
      font-variant-numeric: tabular-nums;
    }
    .rn-status-tab.active .tab-count { background: var(--primary); color: white; }

    /* --- Split Panel Layout -------------------------------------------- */
    .rn-split { display: flex; gap: 1rem; align-items: flex-start; min-height: 0; }
    .rn-split-left {
      flex: 0 0 60%; max-width: 60%; display: flex; flex-direction: column; min-height: 0;
    }
    .rn-split-right {
      flex: 1; min-width: 0; position: sticky;
      top: calc(var(--navbar-height, 60px) + 120px);
      max-height: calc(100vh - 200px); overflow-y: auto;
      background: var(--bg-surface); border: 1.5px solid var(--border-default);
      border-radius: var(--radius-md);
    }

    /* --- Selection Bar ------------------------------------------------- */
    .rn-selection-bar {
      display: flex; align-items: center; justify-content: space-between;
      gap: 0.75rem; padding: 0.5rem 1rem; margin-bottom: 0.5rem;
      background: var(--primary-glow); border: 1.5px solid var(--primary);
      border-radius: var(--radius-md); font-size: 0.8125rem; color: var(--text-primary);
      animation: rnSlideDown 0.2s ease-out;
    }
    @keyframes rnSlideDown { from { opacity:0; transform:translateY(-8px); } to { opacity:1; transform:translateY(0); } }
    .rn-selection-actions { display: flex; gap: 0.375rem; align-items: center; }
    .rn-selection-actions button {
      padding: 0.3125rem 0.625rem; border-radius: var(--radius-sm);
      font-size: 0.75rem; font-weight: 600; cursor: pointer;
      border: 1.5px solid var(--border-default); background: var(--bg-surface);
      color: var(--text-secondary); transition: all var(--transition-fast);
    }
    .rn-selection-actions button:hover { background: var(--bg-elevated); border-color: var(--border-strong); }
    .rn-selection-actions button:last-of-type {
      background: var(--primary); color: white; border-color: var(--primary);
    }
    .rn-selection-actions button:last-of-type:hover {
      background: var(--primary-dim); box-shadow: 0 2px 8px var(--primary-glow);
    }

    /* --- Table --------------------------------------------------------- */
    .rn-table-wrap {
      background: var(--bg-surface); border: 1.5px solid var(--border-default);
      border-radius: var(--radius-md); overflow: hidden;
    }
    .rn-table-info {
      padding: 0.625rem 1rem; border-bottom: 1px solid var(--border-subtle);
      font-size: 0.8125rem; color: var(--text-muted);
    }
    .rn-table-info strong { color: var(--primary); font-variant-numeric: tabular-nums; }
    .rn-table-scroll { overflow-x: auto; }
    .rn-table { width: 100%; border-collapse: collapse; font-size: 0.8125rem; }
    .rn-table thead th {
      padding: 0.625rem 0.75rem; text-align: left; font-size: 0.6875rem;
      font-weight: 700; text-transform: uppercase; letter-spacing: 0.06em;
      color: var(--text-dim); background: var(--bg-elevated);
      border-bottom: 1.5px solid var(--border-default); white-space: nowrap;
      position: sticky; top: 0; z-index: 5;
    }
    .rn-th--urgency { width: 4px; padding: 0 !important; }
    .rn-th--checkbox { width: 36px; text-align: center; padding: 0.625rem 0.25rem !important; }
    .rn-th--days { width: 56px; text-align: center; }
    .rn-th--customer { min-width: 180px; }
    .rn-th--type { width: 80px; }
    .rn-th--plate { width: 120px; }
    .rn-th--company { width: 120px; }
    .rn-th--date { width: 90px; }
    .rn-th--premium { width: 90px; text-align: right; }
    .rn-th--actions { width: 140px; text-align: right; }
    .rn-checkbox { width: 16px; height: 16px; cursor: pointer; accent-color: var(--primary); vertical-align: middle; }
    .rn-row { cursor: pointer; transition: background var(--transition-fast); }
    .rn-row:hover { background: var(--bg-elevated); }
    .rn-row td {
      padding: 0.5rem 0.75rem; border-bottom: 1px solid var(--border-subtle);
      vertical-align: middle; color: var(--text-primary);
    }
    .rn-row.selected { background: var(--primary-glow) !important; }
    .rn-row.selected:hover { background: rgba(99,102,241,0.12) !important; }
    .rn-row td:first-child { padding: 0; width: 4px; position: relative; }
    .rn-urgency-strip { position: absolute; left:0; top:0; bottom:0; width: 4px; }
    .rn-urgency-strip.critical { background: var(--danger); }
    .rn-urgency-strip.warning { background: var(--warning); }
    .rn-urgency-strip.normal { background: var(--info); }
    .rn-days {
      display: inline-flex; align-items: center; justify-content: center;
      min-width: 36px; padding: 0.25rem 0.375rem; border-radius: var(--radius-sm);
      font-size: 0.75rem; font-weight: 700; font-variant-numeric: tabular-nums;
    }
    .rn-days.critical { background: var(--danger-bg); color: var(--danger); }
    .rn-days.warning { background: var(--warning-bg); color: var(--warning); }
    .rn-days.normal { background: var(--info-bg); color: var(--info); }
    .rn-customer-name { font-weight: 600; color: var(--text-primary); font-size: 0.8125rem; line-height: 1.3; }
    .rn-customer-phone {
      font-size: 0.6875rem; color: var(--text-dim); font-variant-numeric: tabular-nums;
      font-family: 'JetBrains Mono', var(--font-mono), monospace;
    }
    .rn-type-pill {
      display: inline-flex; padding: 0.1875rem 0.5rem; border-radius: 2rem;
      font-size: 0.6875rem; font-weight: 700; letter-spacing: 0.02em; white-space: nowrap;
    }
    .rn-plate {
      font-family: 'JetBrains Mono', var(--font-mono), monospace;
      font-size: 0.75rem; font-weight: 500; letter-spacing: 0.02em;
    }
    .rn-date { font-variant-numeric: tabular-nums; font-size: 0.8125rem; white-space: nowrap; }
    .rn-premium {
      font-weight: 600; font-variant-numeric: tabular-nums;
      font-family: 'JetBrains Mono', var(--font-mono), monospace;
      font-size: 0.8125rem; text-align: right; white-space: nowrap;
    }
    .rn-actions { display: flex; gap: 0.375rem; justify-content: flex-end; align-items: center; }
    .rn-row.quoting { background: color-mix(in srgb, var(--info) 5%, var(--bg-surface)) !important; }
    .rn-row-quote-state {
      display: inline-flex; align-items: center; gap: 0.25rem;
      font-size: 0.625rem; font-weight: 700; color: var(--info);
    }
    .rn-row-quote-count { font-family: 'JetBrains Mono', monospace; }
    .rn-act-btn {
      display: inline-flex; align-items: center; gap: 0.25rem;
      padding: 0.3125rem 0.5rem; border-radius: var(--radius-sm);
      font-size: 0.6875rem; font-weight: 600; cursor: pointer;
      border: none; transition: all var(--transition-fast); white-space: nowrap;
    }
    .rn-act-btn svg { width: 12px; height: 12px; flex-shrink: 0; }
    .rn-act-quote { background: var(--primary); color: white; }
    .rn-act-quote:hover { background: var(--primary-dim); box-shadow: 0 2px 8px var(--primary-glow); }
    .rn-act-wa { background: #25D366; color: white; padding: 0.3125rem; }
    .rn-act-wa:hover { background: #20ba59; }

    /* --- Pagination ---------------------------------------------------- */
    .rn-pagination {
      display: flex; justify-content: space-between; align-items: center;
      padding: 0.75rem 1rem; border-top: 1px solid var(--border-subtle);
    }
    .rn-pagination-info { font-size: 0.8125rem; color: var(--text-muted); }
    .rn-pagination-controls { display: flex; gap: 0.25rem; }
    .rn-pg-btn {
      padding: 0.375rem 0.625rem; background: transparent;
      border: 1px solid var(--border-default); border-radius: var(--radius-sm);
      color: var(--text-primary); font-size: 0.8125rem; font-weight: 500;
      cursor: pointer; transition: all var(--transition-fast);
    }
    .rn-pg-btn:hover:not(:disabled) { background: var(--bg-elevated); border-color: var(--border-strong); }
    .rn-pg-btn.active { background: var(--primary); color: white; border-color: var(--primary); }
    .rn-pg-btn:disabled { opacity: 0.35; cursor: not-allowed; }

    /* --- Panel Placeholder --------------------------------------------- */
    .rn-panel-placeholder {
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      padding: 3rem 2rem; text-align: center; color: var(--text-muted); min-height: 300px;
    }
    .rn-panel-placeholder svg { margin-bottom: 1rem; opacity: 0.4; }
    .rn-panel-placeholder h3 { font-size: 1rem; font-weight: 600; margin: 0 0 0.375rem 0; color: var(--text-secondary); }
    .rn-panel-placeholder p { font-size: 0.8125rem; margin: 0; max-width: 240px; line-height: 1.5; }

    /* --- Detail Panel -------------------------------------------------- */
    .rn-detail-header {
      display: flex; flex-direction: column; gap: 0.375rem;
      padding: 0.75rem 1rem; border-bottom: 1px solid var(--border-subtle);
    }
    .rn-detail-header-top { display: flex; justify-content: space-between; align-items: center; }
    .rn-detail-name { font-size: 1rem; font-weight: 700; margin: 0; color: var(--text-primary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 220px; }
    .rn-detail-header-sub {
      display: flex; align-items: center; gap: 0.375rem; flex-wrap: wrap;
      font-size: 0.75rem; color: var(--text-secondary);
    }
    .rn-detail-header-sub .dot { color: var(--text-dim); }
    .rn-detail-badges { display: flex; gap: 0.375rem; flex-wrap: wrap; }
    .rn-detail-badge {
      display: inline-flex; padding: 0.125rem 0.4375rem; border-radius: 2rem;
      font-size: 0.625rem; font-weight: 700;
    }
    .rn-detail-actions {
      display: flex; align-items: center; gap: 0.375rem; flex-wrap: wrap;
      padding: 0.5rem 1rem; border-bottom: 1px solid var(--border-subtle);
    }
    .rn-detail-close {
      background: none; border: none; color: var(--text-dim); cursor: pointer;
      padding: 0.25rem; border-radius: var(--radius-sm);
      transition: all var(--transition-fast); flex-shrink: 0;
    }
    .rn-detail-close:hover { background: var(--bg-elevated); color: var(--text-primary); }

    /* --- Detail Tabs --------------------------------------------------- */
    .rn-detail-tabs {
      display: flex; gap: 0; border-bottom: 2px solid var(--border-subtle);
      padding: 0 1rem; background: var(--bg-surface);
    }
    .rn-detail-tab {
      position: relative; padding: 0.5rem 0.75rem; font-size: 0.75rem; font-weight: 600;
      color: var(--text-dim); cursor: pointer; border: none; background: none;
      transition: color 0.15s; display: flex; align-items: center; gap: 0.375rem;
      border-bottom: 2px solid transparent; margin-bottom: -2px;
    }
    .rn-detail-tab:hover { color: var(--text-secondary); }
    .rn-detail-tab.active { color: var(--primary); border-bottom-color: var(--primary); }
    .rn-detail-tab-badge {
      display: inline-flex; align-items: center; justify-content: center;
      min-width: 16px; height: 16px; padding: 0 4px; border-radius: 999px;
      font-size: 0.5625rem; font-weight: 700; background: var(--bg-elevated); color: var(--text-dim);
    }
    .rn-detail-tab.active .rn-detail-tab-badge { background: var(--primary); color: white; }
    .rn-detail-tab-panel { display: none; padding: 0.75rem 1rem; }
    .rn-detail-tab-panel.active { display: block; }

    /* --- Detail Sections (inside tabs) --------------------------------- */
    .rn-detail-section { padding: 0.5rem 0; border-bottom: 1px solid var(--border-subtle); }
    .rn-detail-section:last-child { border-bottom: none; }
    .rn-detail-section-title {
      font-size: 0.625rem; font-weight: 700; text-transform: uppercase;
      letter-spacing: 0.06em; color: var(--text-dim); margin-bottom: 0.5rem;
      cursor: pointer; display: flex; align-items: center; justify-content: space-between;
    }
    .rn-detail-section.collapsible .rn-detail-section-title::after {
      content: ''; display: inline-block; width: 0; height: 0;
      border-left: 4px solid transparent; border-right: 4px solid transparent;
      border-top: 4px solid currentColor; transition: transform 0.2s;
    }
    .rn-detail-section.collapsed .rn-detail-section-title::after { transform: rotate(-90deg); }
    .rn-detail-section.collapsed > *:not(.rn-detail-section-title) { display: none; }
    .rn-detail-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; }
    .rn-detail-label { font-size: 0.6875rem; color: var(--text-dim); margin-bottom: 0.125rem; }
    .rn-detail-value { font-size: 0.8125rem; font-weight: 500; color: var(--text-primary); }
    .rn-detail-value.mono {
      font-family: 'JetBrains Mono', var(--font-mono), monospace; font-size: 0.75rem;
    }
    .rn-customer-link {
      display: inline-flex; align-items: center; gap: 0.375rem; margin-top: 0.5rem;
      font-size: 0.75rem; font-weight: 600; color: var(--primary); text-decoration: none;
    }
    .rn-customer-link:hover { text-decoration: underline; }
    .rn-customer-link svg { width: 14px; height: 14px; }
    .rn-warnings { display: flex; flex-direction: column; gap: 0.375rem; }
    .rn-warning-item {
      display: flex; align-items: center; gap: 0.375rem; padding: 0.375rem 0.5rem;
      border-radius: var(--radius-sm); font-size: 0.75rem; font-weight: 500;
    }
    .rn-warning-item svg { width: 14px; height: 14px; flex-shrink: 0; }
    .rn-warning-item.warn { background: var(--warning-bg); color: var(--warning); }
    .rn-warning-item.ok { background: var(--success-bg); color: var(--success); }
    .rn-warning-item.info { background: var(--info-bg); color: var(--info); }
    .rn-quote-actions { display: flex; gap: 0.5rem; margin-top: 0.5rem; }
    .rn-quote-status-bar {
      display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem 0.625rem;
      border-radius: var(--radius-sm); font-size: 0.8125rem; margin-top: 0.625rem;
    }
    .rn-quote-status-bar svg { width: 16px; height: 16px; flex-shrink: 0; }
    .rn-quote-status-bar.polling { background: var(--info-bg); color: var(--info); }
    .rn-quote-status-bar.error { background: var(--danger-bg); color: var(--danger); }
    .rn-quote-status-bar.completed { background: var(--success-bg); color: var(--success); }

    /* --- Share Section (NEW) ------------------------------------------- */
    .rn-share-section { padding: 0.75rem 1.25rem; }
    .rn-share-actions { display: flex; gap: 0.375rem; flex-wrap: wrap; }
    .rn-share-btn {
      display: inline-flex; align-items: center; gap: 0.25rem;
      padding: 0.375rem 0.625rem; border-radius: var(--radius-sm);
      font-size: 0.6875rem; font-weight: 600; cursor: pointer;
      border: 1px solid var(--border-default); background: var(--bg-surface);
      color: var(--text-secondary); transition: all var(--transition-fast);
    }
    .rn-share-btn:hover { background: var(--bg-elevated); border-color: var(--border-strong); }
    .rn-share-btn--wa { background: #25d366; color: #fff; border-color: #25d366; }
    .rn-share-btn--wa:hover { background: #1da851; border-color: #1da851; }
    .rn-share-btn svg { width: 14px; height: 14px; }
    .rn-doc-item {
      display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem;
      border-radius: var(--radius-sm); background: var(--bg-base); margin-bottom: 0.375rem;
    }
    .rn-doc-icon { width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
    .rn-doc-name { flex: 1; font-size: 0.75rem; font-weight: 500; color: var(--text-primary); }
    .rn-doc-actions { display: flex; gap: 0.25rem; }

    /* --- Offer Cards (compact single-line) -------------------------------- */
    .rn-offers-grid {
      display: flex; flex-direction: column; gap: 0; margin-top: 0.375rem;
      border: 1px solid var(--border-subtle); border-radius: 6px; overflow: hidden;
    }
    .rn-offers-header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 0.3rem 0.5rem; background: var(--bg-elevated);
      font-size: 0.625rem; font-weight: 600; color: var(--text-muted);
      border-bottom: 1px solid var(--border-subtle);
    }
    .rn-offers-count {
      font-size: 0.5625rem; padding: 1px 5px; border-radius: 9px;
      background: var(--primary); color: white;
    }
    .rn-offer {
      display: flex; align-items: center; gap: 0.375rem;
      padding: 0.25rem 0.5rem; border-bottom: 1px solid var(--border-subtle);
      transition: background var(--transition-fast); min-height: 28px;
    }
    .rn-offer:last-child { border-bottom: none; }
    .rn-offer:hover { background: var(--bg-elevated); }
    .rn-offer-status {
      display: inline-flex; align-items: center; flex-shrink: 0;
      padding: 0px 4px; border-radius: 3px; font-size: 0.5625rem; font-weight: 700; line-height: 1.4;
    }
    .rn-offer-status--onay { background: #dcfce7; color: #16a34a; }
    .rn-offer-status--red { background: #fee2e2; color: #dc2626; }
    .rn-offer-status--belirsiz { background: #fef3c7; color: #d97706; }
    .rn-offer-status--hata { background: #fee2e2; color: #dc2626; }
    .rn-offer-company {
      font-size: 0.75rem; font-weight: 600; color: var(--text-primary);
      flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
    }
    .rn-offer-premium {
      font-family: 'JetBrains Mono', var(--font-mono), monospace;
      font-size: 0.75rem; font-weight: 800; color: var(--text-primary); white-space: nowrap; flex-shrink: 0;
    }
    .rn-offer.cheapest { background: rgba(22,163,74,0.06); }
    .rn-offer.cheapest .rn-offer-premium { color: var(--success); }
    .rn-offer.cheapest .rn-offer-company::before {
      content: ''; display: inline-block; width: 5px; height: 5px;
      border-radius: 50%; background: var(--success); margin-right: 4px; vertical-align: middle;
    }
    .rn-offer.error { opacity: 0.5; }
    .rn-offer.error .rn-offer-premium { color: var(--danger); font-size: 0.6875rem; }
    .rn-offer.rejected { opacity: 0.6; }
    .rn-offer.rejected .rn-offer-premium { color: var(--warning); font-size: 0.6875rem; }
    .rn-last-query-info {
      display: flex; align-items: center; gap: 0.5rem;
      padding: 0.375rem 0.75rem; margin-bottom: 0.5rem;
      background: var(--bg-elevated); border: 1px solid var(--border-subtle);
      border-radius: 6px; font-size: 0.6875rem; color: var(--text-muted);
    }
    .rn-last-query-info svg { width: 12px; height: 12px; flex-shrink: 0; }
    .rn-last-query-info strong { color: var(--text-primary); font-weight: 600; }

    /* --- Wizard Panel -------------------------------------------------- */
    .rn-panel-wizard { flex-direction: column; min-height: 400px; }
    .rn-wiz-steps {
      display: flex; align-items: center; gap: 0;
      padding: 1rem 1.25rem; border-bottom: 1px solid var(--border-subtle);
    }
    .rn-wiz-step {
      display: flex; align-items: center; gap: 0.375rem;
      font-size: 0.75rem; font-weight: 600; color: var(--text-dim);
      cursor: pointer; transition: color var(--transition-fast);
    }
    .rn-wiz-step:hover { color: var(--text-secondary); }
    .rn-wiz-step.active { color: var(--primary); }
    .rn-wiz-step.completed { color: var(--success); }
    .rn-wiz-num {
      width: 24px; height: 24px; display: flex; align-items: center; justify-content: center;
      border-radius: 50%; font-size: 0.6875rem; font-weight: 700;
      background: var(--bg-elevated); border: 2px solid var(--border-default);
      transition: all var(--transition-fast);
    }
    .rn-wiz-step.active .rn-wiz-num { background: var(--primary); border-color: var(--primary); color: white; }
    .rn-wiz-step.completed .rn-wiz-num { background: var(--success); border-color: var(--success); color: white; }
    .rn-wiz-connector { flex: 1; height: 2px; background: var(--border-default); margin: 0 0.5rem; }
    .rn-wiz-connector.completed { background: var(--success); }
    .rn-wiz-panel { display: none; flex: 1; overflow-y: auto; padding: 1rem 1.25rem; }
    .rn-wiz-panel.active { display: block; }
    .rn-wiz-footer {
      display: flex; justify-content: space-between;
      padding: 0.75rem 1.25rem; border-top: 1px solid var(--border-subtle); flex-shrink: 0;
    }
    .rn-review-card {
      display: flex; flex-direction: column; gap: 0.375rem; padding: 0.75rem;
      background: var(--bg-base); border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm); margin-bottom: 0.5rem;
    }
    .rn-review-card-header { display: flex; justify-content: space-between; align-items: center; }
    .rn-review-card-name { font-weight: 600; font-size: 0.8125rem; }
    .rn-review-row { display: flex; align-items: center; gap: 0.375rem; font-size: 0.75rem; }
    .rn-review-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
    .rn-review-dot.ok { background: var(--success); }
    .rn-review-dot.missing { background: var(--danger); }
    .rn-review-inline-input {
      padding: 0.25rem 0.5rem; font-size: 0.75rem;
      border: 1px solid var(--border-default); border-radius: var(--radius-sm);
      background: var(--bg-surface); color: var(--text-primary); width: 140px;
    }
    .rn-review-inline-input:focus { outline: none; border-color: var(--primary); }
    .rn-review-banner {
      display: flex; align-items: center; gap: 0.5rem; padding: 0.625rem 0.75rem;
      border-radius: var(--radius-sm); font-size: 0.8125rem; font-weight: 600; margin-bottom: 0.75rem;
    }
    .rn-review-banner svg { width: 18px; height: 18px; flex-shrink: 0; }
    .rn-review-banner.ok { background: var(--success-bg); color: var(--success); }
    .rn-review-banner.warn { background: var(--warning-bg); color: var(--warning); }
    .rn-send-summary { display: flex; flex-direction: column; gap: 0.375rem; margin-bottom: 0.75rem; }
    .rn-send-summary-item { display: flex; justify-content: space-between; align-items: center; font-size: 0.8125rem; }
    .rn-send-summary-item .label { color: var(--text-muted); }
    .rn-send-summary-item .value { font-weight: 600; font-variant-numeric: tabular-nums; }
    .rn-send-progress { margin: 0.75rem 0; }
    .rn-send-progress-bar {
      width: 100%; height: 6px; background: var(--bg-elevated);
      border-radius: 3px; overflow: hidden; margin-bottom: 0.375rem;
    }
    .rn-send-progress-fill {
      height: 100%; background: linear-gradient(90deg, var(--primary), var(--primary-light));
      border-radius: 3px; transition: width 0.3s ease; width: 0%;
    }
    .rn-send-progress-text { font-size: 0.75rem; color: var(--text-muted); text-align: center; }
    .rn-send-status-row {
      display: flex; align-items: center; gap: 0.5rem; padding: 0.375rem 0;
      border-bottom: 1px solid var(--border-subtle); font-size: 0.75rem;
    }
    .rn-send-status-row:last-child { border-bottom: none; }
    .rn-send-status-icon { width: 16px; height: 16px; flex-shrink: 0; }
    .rn-send-status-name { font-weight: 600; flex: 1; min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .rn-send-status-msg { color: var(--text-muted); max-width: 160px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .rn-track-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.5rem; margin-bottom: 0.75rem; }
    .rn-track-stat {
      text-align: center; padding: 0.5rem; background: var(--bg-base);
      border-radius: var(--radius-sm); border: 1px solid var(--border-subtle);
    }
    .rn-track-stat-value { font-size: 1.25rem; font-weight: 700; font-variant-numeric: tabular-nums; }
    .rn-track-stat-label { font-size: 0.625rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.04em; margin-top: 0.125rem; }
    .rn-track-auto { display: flex; align-items: center; gap: 0.375rem; font-size: 0.75rem; color: var(--info); margin-bottom: 0.75rem; }
    .rn-track-card {
      padding: 0.625rem 0.75rem; background: var(--bg-base);
      border: 1px solid var(--border-subtle); border-radius: var(--radius-sm); margin-bottom: 0.5rem;
    }
    .rn-track-card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.375rem; }
    .rn-track-card-name { font-weight: 600; font-size: 0.8125rem; }
    .rn-track-card-status { font-size: 0.6875rem; font-weight: 700; padding: 0.125rem 0.4375rem; border-radius: 2rem; }

    /* --- State Badges -------------------------------------------------- */
    .rn-state-badge {
      display: inline-flex; align-items: center; gap: 4px;
      padding: 3px 10px; border-radius: 9999px; font-size: 0.625rem;
      font-weight: 600; white-space: nowrap; line-height: 1.4;
      cursor: pointer; transition: all 0.15s; position: relative; user-select: none;
    }
    .rn-state-badge:hover { filter: brightness(0.92); transform: scale(1.04); }
    .rn-state-badge::after {
      content: ''; display: inline-block; width: 0; height: 0;
      border-left: 3px solid transparent; border-right: 3px solid transparent;
      border-top: 3px solid currentColor; margin-left: 2px; opacity: 0.5;
    }
    .rn-state-badge--bekliyor   { background: var(--warning-bg); color: var(--warning); }
    .rn-state-badge--teklif     { background: #dbeafe; color: #2563eb; }
    .rn-state-badge--iletildi   { background: #e0e7ff; color: #4f46e5; }
    .rn-state-badge--policelesti { background: var(--success-bg); color: var(--success); }
    .rn-state-badge--reddetti   { background: var(--danger-bg); color: var(--danger); }
    .rn-state-select {
      padding: 0.375rem 0.5rem; border-radius: 6px; font-size: 0.75rem;
      border: 1px solid var(--border-default); background: var(--bg-surface);
      cursor: pointer; color: var(--text-primary); outline: none; transition: border-color 0.15s;
    }
    .rn-state-select:focus { border-color: var(--primary); }

    /* --- Query Log ----------------------------------------------------- */
    .rn-detail-queries { margin-top: 0.5rem; }
    .rn-query-entry {
      display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem;
      border-radius: 6px; background: var(--bg-base); margin-bottom: 0.375rem; font-size: 0.75rem;
    }
    .rn-query-time { color: var(--text-dim); font-variant-numeric: tabular-nums; white-space: nowrap; }
    .rn-query-type-badge { padding: 1px 6px; border-radius: 4px; font-size: 0.625rem; font-weight: 600; background: #f3f4f6; color: #374151; }
    .rn-query-result { margin-left: auto; font-weight: 600; color: var(--primary); white-space: nowrap; }

    /* --- TC Query History (Teklif tab) --------------------------------- */
    .rn-tc-query-history { margin-bottom: 0.75rem; }
    .rn-qh-entry {
      display: flex; align-items: center; gap: 0.375rem; padding: 0.375rem 0.5rem;
      border-radius: 6px; background: var(--bg-base); margin-bottom: 0.25rem;
      font-size: 0.6875rem; cursor: pointer; transition: background 0.15s, border-color 0.15s;
      border: 1px solid transparent;
    }
    .rn-qh-entry:hover { background: color-mix(in srgb, var(--primary) 8%, var(--bg-base)); }
    .rn-qh-entry--latest { border-left: 2px solid var(--primary); }
    .rn-qh-entry--active { background: color-mix(in srgb, var(--primary) 12%, var(--bg-base)); border-color: color-mix(in srgb, var(--primary) 30%, transparent); }
    .rn-qh-date { color: var(--text-secondary); font-variant-numeric: tabular-nums; white-space: nowrap; }
    .rn-qh-ago { color: var(--text-dim); font-size: 0.625rem; white-space: nowrap; }
    .rn-qh-extra { font-size: 0.5625rem; padding: 1px 4px; border-radius: 3px; background: color-mix(in srgb, var(--text-dim) 12%, transparent); color: var(--text-secondary); white-space: nowrap; }
    .rn-qh-id { margin-left: auto; font-family: 'JetBrains Mono', monospace; font-size: 0.5625rem; color: var(--text-dim); white-space: nowrap; }

    /* --- Documents in Teklif tab (above offers) ------------------------ */
    .rn-docs-section { margin-bottom: 0.5rem; }
    .rn-docs-section:empty { display: none; }

    /* --- Spinner & Loading --------------------------------------------- */
    .rn-spinner {
      width: 32px; height: 32px; border: 3px solid var(--border-default);
      border-top-color: var(--primary); border-radius: 50%; animation: rnSpin 0.7s linear infinite;
    }
    @keyframes rnSpin { to { transform: rotate(360deg); } }
    .rn-pulse-dot {
      width: 8px; height: 8px; border-radius: 50%; background: var(--info);
      animation: rnPulse 1.5s ease-in-out infinite;
    }
    @keyframes rnPulse { 0%,100% { opacity:0.4; transform:scale(0.8); } 50% { opacity:1; transform:scale(1.2); } }
    .rn-loading, .rn-empty {
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      padding: 3rem 2rem; gap: 0.75rem; color: var(--text-muted); font-size: 0.875rem;
    }

    /* --- SSE Connection ------------------------------------------------ */
    .rn-connection-indicator {
      display: inline-flex; align-items: center; gap: 0.375rem;
      font-size: 0.625rem; color: var(--text-dim);
    }
    .rn-connection-dot {
      width: 6px; height: 6px; border-radius: 50%; background: #ef4444; transition: background 0.3s;
    }
    .rn-connection-dot.connected { background: #22c55e; }
    .rn-connection-dot.reconnecting { background: #f59e0b; animation: rnConnPulse 1s infinite; }
    @keyframes rnConnPulse { 0%,100% { opacity:1; } 50% { opacity:0.4; } }

    /* SSE Realtime Offer Cards (compact single-line) */
    .rn-rt-offer {
      display: flex; align-items: center; gap: 0.375rem;
      padding: 0.25rem 0.5rem; border-radius: 4px;
      background: var(--bg-surface); border: 1px solid var(--border-default);
      margin-bottom: 0.125rem; transition: opacity 0.3s, transform 0.3s; min-height: 28px;
    }
    .rn-rt-offer.rejected { opacity: 0.5; }
    .rn-rt-offer.error { border-color: var(--danger); opacity: 0.5; }
    .rn-rt-offer-company { font-size: 0.75rem; font-weight: 600; color: var(--text-primary); flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .rn-rt-offer-premium { font-size: 0.75rem; font-weight: 700; color: var(--primary); margin-left: auto; font-variant-numeric: tabular-nums; white-space: nowrap; flex-shrink: 0; }
    .rn-rt-offer-proposal { display: none; }
    .rn-rt-offer-desc { display: none; }
    .rn-rt-offers-header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 0.3rem 0; margin-bottom: 0.25rem;
      font-size: 0.6875rem; font-weight: 600; color: var(--text-primary);
      border-bottom: 1px solid var(--border-default);
    }
    .rn-rt-offers-count { font-size: 0.625rem; padding: 1px 6px; border-radius: 9999px; background: var(--primary); color: white; }

    /* --- Quote History -------------------------------------------------- */
    .rn-history-section {
      margin-top: 1.5rem; background: var(--bg-surface);
      border: 1.5px solid var(--border-default); border-radius: var(--radius-md); overflow: hidden;
    }
    .rn-history-section[open] .rn-history-header { border-bottom: 1px solid var(--border-subtle); }
    .rn-history-header {
      display: flex; justify-content: space-between; align-items: center;
      padding: 0.75rem 1rem; cursor: pointer; list-style: none; user-select: none;
    }
    .rn-history-header::-webkit-details-marker { display: none; }
    .rn-history-header-left { display: flex; align-items: center; gap: 0.5rem; color: var(--text-primary); }
    .rn-history-title { font-size: 0.9375rem; font-weight: 700; margin: 0; }
    .rn-history-badge {
      display: inline-flex; align-items: center; justify-content: center;
      min-width: 22px; height: 22px; padding: 0 0.375rem; border-radius: 2rem;
      font-size: 0.6875rem; font-weight: 700; background: var(--primary-glow);
      color: var(--primary); font-variant-numeric: tabular-nums;
    }
    .rn-history-empty {
      display: flex; align-items: center; justify-content: center;
      padding: 2rem; color: var(--text-muted); font-size: 0.8125rem;
    }
    .rn-history-table { width: 100%; border-collapse: collapse; font-size: 0.8125rem; }
    .rn-history-table thead th {
      padding: 0.5rem 0.75rem; text-align: left; font-size: 0.6875rem;
      font-weight: 700; text-transform: uppercase; letter-spacing: 0.06em;
      color: var(--text-dim); background: var(--bg-elevated);
      border-bottom: 1.5px solid var(--border-default); white-space: nowrap;
    }
    .rn-history-table tbody tr { cursor: pointer; transition: background var(--transition-fast); }
    .rn-history-table tbody tr:hover { background: var(--bg-elevated); }
    .rn-history-table td {
      padding: 0.5rem 0.75rem; border-bottom: 1px solid var(--border-subtle);
      vertical-align: middle; color: var(--text-primary);
    }
    .rn-history-result { display: inline-flex; gap: 0.5rem; font-size: 0.75rem; font-weight: 600; }
    .rn-history-result .onay { color: var(--success); }
    .rn-history-result .red { color: var(--danger); }
    .rn-history-result .belirsiz { color: var(--warning); }
    .rn-history-source {
      display: inline-flex; padding: 0.125rem 0.4375rem; border-radius: 2rem;
      font-size: 0.625rem; font-weight: 700; text-transform: uppercase;
      letter-spacing: 0.04em; background: var(--bg-elevated); color: var(--text-dim);
    }
    .rn-history-batch {
      border: 1px solid #c7d2fe; border-radius: 8px; margin-bottom: 0.75rem; overflow: hidden;
    }
    .rn-history-batch-header {
      display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem 0.75rem;
      background: #eef2ff; font-size: 0.75rem; font-weight: 600; color: var(--primary);
    }
    .rn-history-batch-body { padding: 0; }
    .rn-history-batch-body .rn-history-table { margin: 0; }

    /* --- Modals (page-level overrides) --------------------------------- */
    .modal {
      display: none; position: fixed; top:0; left:0; right:0; bottom:0;
      z-index: 10000; align-items: center; justify-content: center;
    }
    .modal.show { display: flex; }
    .modal > .modal-overlay {
      position: absolute; top:0; left:0; right:0; bottom:0;
      background: rgba(0,0,0,0.55); backdrop-filter: blur(4px);
    }
    .modal > .modal-content {
      position: relative; width: 90%; max-width: 600px;
      background: var(--bg-surface); border-radius: var(--radius-lg);
      box-shadow: var(--shadow-xl); max-height: 90vh; overflow-y: auto;
    }
    .modal-header {
      display: flex; justify-content: space-between; align-items: center;
      padding: 1.25rem 1.5rem; border-bottom: 1px solid var(--border-default);
    }
    .modal-header h3 { font-size: 1.125rem; font-weight: 700; margin: 0; }
    .modal-close {
      width: 28px; height: 28px; display: flex; align-items: center; justify-content: center;
      background: transparent; border: none; color: var(--text-dim); cursor: pointer;
      border-radius: var(--radius-sm); transition: all var(--transition-fast);
    }
    .modal-close:hover { background: var(--bg-elevated); color: var(--text-primary); }
    .modal-close svg { width: 18px; height: 18px; }
    .modal-body { padding: 1.25rem 1.5rem; }
    .modal-description { color: var(--text-muted); margin-bottom: 1.25rem; font-size: 0.875rem; }
    .tss-customer-note {
      display: flex; align-items: center; gap: 0.5rem;
      padding: 0.5rem 0.75rem; border-radius: 8px;
      background: #dbeafe; color: #1d4ed8;
      font-size: 0.75rem; margin-top: -0.5rem; margin-bottom: 1rem;
    }
    .modal-field { margin-bottom: 1rem; }
    .modal-label { display: block; font-size: 0.8125rem; font-weight: 600; color: var(--text-secondary); margin-bottom: 0.375rem; }
    .modal-input, .modal-select {
      width: 100%; padding: 0.5rem 0.75rem;
      background: var(--bg-base); border: 1.5px solid var(--border-default);
      border-radius: var(--radius-sm); color: var(--text-primary);
      font-size: 0.8125rem; transition: border-color var(--transition-fast);
    }
    .modal-input:focus, .modal-select:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px var(--primary-glow); }
    .modal-footer {
      display: flex; gap: 0.625rem; padding: 1rem 1.5rem; border-top: 1px solid var(--border-default);
    }
    .btn-modal {
      flex: 1; padding: 0.625rem 1.25rem; border-radius: var(--radius-sm);
      font-size: 0.875rem; font-weight: 600; cursor: pointer;
      transition: all var(--transition-fast); border: none;
    }
    .btn-modal.btn-outline { background: transparent; color: var(--text-secondary); border: 1.5px solid var(--border-default); }
    .btn-modal.btn-outline:hover { background: var(--bg-elevated); }
    .btn-modal.btn-primary { background: var(--primary); color: white; }
    .btn-modal.btn-primary:hover { background: var(--primary-dim); }
    .tc-assign-info {
      display: flex; align-items: flex-start; gap: 0.5rem; padding: 0.75rem;
      background: var(--warning-bg); border: 1px solid rgba(245,158,11,0.2);
      border-radius: var(--radius-sm); font-size: 0.8125rem;
      color: var(--text-secondary); line-height: 1.5;
    }
    .tc-assign-divider {
      display: flex; align-items: center; gap: 0.75rem;
      margin: 0.75rem 0; color: var(--text-dim); font-size: 0.75rem;
    }
    .tc-assign-divider::before, .tc-assign-divider::after { content: ''; flex: 1; height: 1px; background: var(--border-default); }
    .tc-assign-customer-link {
      display: flex; align-items: center; gap: 0.5rem; padding: 0.625rem;
      margin-top: 0.75rem; background: var(--info-bg);
      border: 1px solid rgba(59,130,246,0.15); border-radius: var(--radius-sm);
      font-size: 0.8125rem; color: var(--text-secondary);
    }
    .tc-assign-customer-link a { color: var(--primary); font-weight: 600; text-decoration: none; margin-left: auto; }
    .form-grid { display: flex; flex-wrap: wrap; gap: 0.75rem; }
    .form-grid .modal-field { width: 100%; margin-bottom: 0; }
    .form-grid .modal-field.half { width: calc(50% - 0.375rem); }
    .form-grid .modal-field.full { width: 100%; }

    /* --- State Popover Portal ------------------------------------------ */
    #statePopoverPortal {
      position: fixed; top: 0; left: 0; width: 0; height: 0;
      z-index: 2147483647; pointer-events: none;
    }
    .rn-state-popover {
      position: fixed; pointer-events: auto;
      background: #1e1e2e; border: 1px solid rgba(255,255,255,0.12);
      border-radius: 10px; padding: 4px; min-width: 170px;
      box-shadow: 0 12px 32px rgba(0,0,0,0.4), 0 4px 12px rgba(0,0,0,0.2);
      animation: rnPopIn 0.12s ease-out;
    }
    @keyframes rnPopIn { from { opacity:0; transform:translateY(-4px) scale(0.96); } to { opacity:1; transform:translateY(0) scale(1); } }
    .rn-state-popover-item {
      display: flex; align-items: center; gap: 8px; padding: 7px 10px;
      border-radius: 7px; font-size: 0.75rem; font-weight: 500;
      cursor: pointer; color: #e0e0e0; transition: background 0.1s;
    }
    .rn-state-popover-item:hover { background: rgba(255,255,255,0.08); }
    .rn-state-popover-item.current { background: rgba(99,102,241,0.15); font-weight: 700; color: #fff; }
    .rn-state-popover-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
    .rn-state-popover-check { margin-left: auto; color: #818cf8; opacity: 0; }
    .rn-state-popover-item.current .rn-state-popover-check { opacity: 1; }
    .rn-state-popover-sep { height: 1px; background: rgba(255,255,255,0.08); margin: 3px 6px; }

    /* --- Test Panel ----------------------------------------------------- */
    .test-panel {
      margin-top: 1.5rem; background: var(--bg-surface);
      border: 1.5px solid var(--border-default); border-radius: var(--radius-md); overflow: hidden;
    }
    .test-panel-header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 0.75rem 1rem; cursor: pointer; user-select: none;
      transition: background var(--transition-fast);
    }
    .test-panel-header:hover { background: var(--bg-elevated); }
    .test-panel-title {
      display: flex; align-items: center; gap: 0.5rem;
      font-size: 0.8125rem; font-weight: 600; color: var(--primary);
    }
    .test-panel-chevron { transition: transform var(--transition-fast); }
    .test-panel-body { padding: 0 1rem 1rem; border-top: 1px solid var(--border-subtle); }
    .test-panel-desc { font-size: 0.75rem; color: var(--text-muted); margin: 0.75rem 0; }
    .test-form-grid {
      display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 0.75rem;
    }
    .test-form-grid .modal-field { margin-bottom: 0; }
    .test-section-label {
      font-size: 0.6875rem; font-weight: 700; text-transform: uppercase;
      letter-spacing: 0.06em; color: var(--primary);
      margin: 1rem 0 0.5rem; padding-bottom: 0.375rem;
      border-bottom: 2px solid var(--primary-glow);
    }
    .test-panel-actions {
      display: flex; gap: 0.5rem; margin-top: 1rem;
      padding-top: 0.75rem; border-top: 1px solid var(--border-subtle);
    }
    .test-log {
      background: var(--bg-elevated); border: 1px solid var(--border-default);
      border-radius: var(--radius-sm); padding: 0.5rem 0.75rem;
      max-height: 180px; overflow-y: auto;
      font-family: 'JetBrains Mono', var(--font-mono), monospace;
      font-size: 0.6875rem; line-height: 1.7; color: var(--text-secondary);
    }
    .test-log .log-entry { padding: 0.0625rem 0; border-bottom: 1px solid var(--border-subtle); }
    .test-log .log-entry:last-child { border-bottom: none; }
    .test-log .log-time { color: var(--primary); font-weight: 600; margin-right: 0.375rem; }
    .test-log .log-success { color: var(--success); }
    .test-log .log-error { color: var(--danger); }
    .test-log .log-info { color: var(--info); }

    /* --- Responsive ---------------------------------------------------- */
    @media (max-width: 1024px) {
      .rn-split { flex-direction: column; }
      .rn-split-left { flex: 1; max-width: 100%; }
      .rn-split-right { position: static; max-height: none; width: 100%; }
      .rn-toolbar-row { flex-wrap: wrap; }
      .rn-toolbar-sep { display: none; }
      .rn-status-tabs { width: 100%; overflow-x: auto; }
      .rn-stats-row { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 768px) {
      .rn-header { flex-direction: column; }
      .rn-header-actions { width: 100%; }
      .rn-header-actions .rn-btn { flex: 1; justify-content: center; }
      .rn-select { min-width: 80px; }
      .rn-th--company, .rn-th--plate { display: none; }
      .rn-table .rn-row td:nth-child(6),
      .rn-table .rn-row td:nth-child(7) { display: none; }
      .form-grid .modal-field.half { width: 100%; }
      .rn-stats-row { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 480px) {
      .rn-stats-row { grid-template-columns: 1fr; }
      .rn-search-wrap { max-width: 100%; }
      .rn-status-tabs { flex-wrap: nowrap; }
      .rn-selection-bar { flex-direction: column; text-align: center; }
      .rn-selection-actions { justify-content: center; flex-wrap: wrap; }
    }
  </style>

  <!-- Popover portal: outside .app-container to avoid stacking context issues -->
  <div id="statePopoverPortal"></div>

  <script src="../../assets/js/pages/customers/renewals.js"></script>
</body>
</html>
