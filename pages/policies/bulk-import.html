<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Toplu Aktarım - IHSAN AI</title>
  <link rel="stylesheet" href="../../assets/css/main.css">
  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
  <!-- SheetJS for reading Excel headers -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
</head>
<body>
  <div class="gradient-mesh"></div>
  <div class="app-container">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar"></aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Navbar -->
      <nav class="navbar">
        <div class="navbar-left">
          <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Menü">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </button>
          <div class="navbar-breadcrumb">
            <span class="breadcrumb-item">Poliçe İşlemleri</span>
            <span class="breadcrumb-separator">/</span>
            <span class="breadcrumb-item active">Toplu Aktarım</span>
          </div>
        </div>
        <div class="navbar-right">
          <button class="navbar-btn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9"/>
              <path d="M13.73 21a2 2 0 01-3.46 0"/>
            </svg>
            <span class="badge">3</span>
          </button>
          <div class="navbar-divider"></div>
          <div class="navbar-user">
            <div class="navbar-avatar" id="userAvatar"></div>
            <div class="navbar-user-info">
              <div class="navbar-user-name" id="userName">Yükleniyor...</div>
              <div class="navbar-user-role" id="userRole"></div>
            </div>
          </div>
        </div>
      </nav>

      <!-- Page Wrapper -->
      <div class="page-wrapper">
        <div class="page-content">
          <!-- Page Header -->
          <div class="page-header">
            <div>
              <h1 class="page-title">Toplu Poliçe Aktarımı</h1>
              <p class="page-subtitle">Sigorta şirketlerinden gelen Excel dosyalarından toplu poliçe yükleyin</p>
            </div>
          </div>

          <!-- Step Wizard -->
          <div class="wizard-steps">
            <div class="wizard-step active" id="wizardStep1">
              <div class="wizard-step-number">
                <span class="step-num">1</span>
                <svg class="step-check" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                  <polyline points="20,6 9,17 4,12"/>
                </svg>
              </div>
              <div class="wizard-step-content">
                <div class="wizard-step-title">Dosya Yükle</div>
                <div class="wizard-step-desc">Excel dosyası seçin</div>
              </div>
            </div>
            <div class="wizard-connector"></div>
            <div class="wizard-step" id="wizardStep2">
              <div class="wizard-step-number">
                <span class="step-num">2</span>
                <svg class="step-check" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                  <polyline points="20,6 9,17 4,12"/>
                </svg>
              </div>
              <div class="wizard-step-content">
                <div class="wizard-step-title">Önizleme</div>
                <div class="wizard-step-desc">Verileri kontrol edin</div>
              </div>
            </div>
            <div class="wizard-connector"></div>
            <div class="wizard-step" id="wizardStep3">
              <div class="wizard-step-number">
                <span class="step-num">3</span>
                <svg class="step-check" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                  <polyline points="20,6 9,17 4,12"/>
                </svg>
              </div>
              <div class="wizard-step-content">
                <div class="wizard-step-title">Tamamlandı</div>
                <div class="wizard-step-desc">Poliçeleri kaydedin</div>
              </div>
            </div>
          </div>

          <!-- Step 1: Upload Card -->
          <div class="card" id="uploadCard">
            <div class="card-header">
              <h3 class="card-title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
                  <polyline points="17,8 12,3 7,8"/>
                  <line x1="12" y1="3" x2="12" y2="15"/>
                </svg>
                Dosya Yükle
              </h3>
            </div>
            <div class="card-body">
              <!-- Sigorta Şirketi Seçimi -->
              <div class="form-group">
                <label class="form-label">Sigorta Şirketi</label>
                <select class="form-select" id="sigortaSirketiSelect">
                  <option value="">Otomatik Tespit (Dosya adından)</option>
                </select>
                <span class="form-hint">Dosya adından şirket otomatik tespit edilir. İsterseniz manuel seçebilirsiniz.</span>
                <!-- Tespit Sonucu -->
                <div class="detection-result" id="detectionResult" style="display: none;">
                  <div class="detection-success" id="detectionSuccess" style="display: none;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M22 11.08V12a10 10 0 11-5.93-9.14"/>
                      <polyline points="22,4 12,14.01 9,11.01"/>
                    </svg>
                    <span>Tespit Edilen Şirket: <strong id="detectedCompanyName"></strong></span>
                  </div>
                  <div class="detection-warning" id="detectionWarning" style="display: none;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/>
                      <line x1="12" y1="9" x2="12" y2="13"/>
                      <line x1="12" y1="17" x2="12.01" y2="17"/>
                    </svg>
                    <span>Şirket tespit edilemedi. Lütfen yukarıdan manuel olarak seçin.</span>
                  </div>
                  <div class="detection-mismatch" id="detectionMismatch" style="display: none;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <circle cx="12" cy="12" r="10"/>
                      <line x1="12" y1="8" x2="12" y2="12"/>
                      <line x1="12" y1="16" x2="12.01" y2="16"/>
                    </svg>
                    <span id="detectionMismatchText"></span>
                  </div>
                </div>
              </div>

              <!-- Upload Zone -->
              <div class="upload-dropzone" id="uploadDropzone">
                <input type="file" accept=".xlsx,.xls,.csv,.xml" id="fileInput">
                <div class="dropzone-content">
                  <div class="dropzone-icon">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                      <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
                      <polyline points="17,8 12,3 7,8"/>
                      <line x1="12" y1="3" x2="12" y2="15"/>
                    </svg>
                  </div>
                  <div class="dropzone-text">
                    <span class="dropzone-title">Dosyayı buraya sürükleyin</span>
                    <span class="dropzone-subtitle">veya tıklayarak seçin</span>
                  </div>
                  <div class="dropzone-formats">
                    <span class="format-badge">.xlsx</span>
                    <span class="format-badge">.xls</span>
                    <span class="format-badge">.csv</span>
                    <span class="format-badge">.xml</span>
                  </div>
                </div>
                <div class="dropzone-selected" id="selectedFileInfo" style="display: none;">
                  <div class="selected-file-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                      <polyline points="14,2 14,8 20,8"/>
                    </svg>
                  </div>
                  <div class="selected-file-info">
                    <span class="selected-file-name" id="selectedFileName"></span>
                    <span class="selected-file-size" id="selectedFileSize"></span>
                  </div>
                  <button class="selected-file-remove" id="removeFileBtn" type="button">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="18" y1="6" x2="6" y2="18"/>
                      <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                  </button>
                </div>
              </div>

              <!-- Supported Formats -->
              <div class="supported-formats">
                <div class="formats-header">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="16" x2="12" y2="12"/>
                    <line x1="12" y1="8" x2="12.01" y2="8"/>
                  </svg>
                  <span>Desteklenen Formatlar (8 Sigorta Şirketi)</span>
                </div>
                <div class="formats-grid" id="supportedFormatsGrid">
                  <!-- Logos will be loaded dynamically -->
                </div>
              </div>

              <!-- Upload Button -->
              <div class="upload-actions">
                <button class="btn btn-primary btn-lg" id="uploadBtn" disabled>
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
                    <polyline points="17,8 12,3 7,8"/>
                    <line x1="12" y1="3" x2="12" y2="15"/>
                  </svg>
                  Dosyayı Yükle ve Analiz Et
                </button>
              </div>
            </div>
          </div>

          <!-- Loading State -->
          <div class="card" id="loadingCard" style="display: none;">
            <div class="card-body">
              <div class="loading-state">
                <div class="windows-spinner"></div>
                <div class="loading-text">
                  <span class="loading-title">Excel dosyası işleniyor...</span>
                  <span class="loading-subtitle">Lütfen bekleyin, veriler analiz ediliyor</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Step 2: Preview Card -->
          <div class="card" id="previewCard" style="display: none;">
            <div class="card-header">
              <h3 class="card-title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                  <circle cx="12" cy="12" r="3"/>
                </svg>
                Önizleme - <span id="detectedFormat">Tespit Edilen Format</span>
              </h3>
              <div class="card-actions">
                <span class="status-pill success" id="validCountBadge">
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="20,6 9,17 4,12"/>
                  </svg>
                  Geçerli: 0
                </span>
                <span class="status-pill danger" id="invalidCountBadge">
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="15" y1="9" x2="9" y2="15"/>
                    <line x1="9" y1="9" x2="15" y2="15"/>
                  </svg>
                  Hatalı: 0
                </span>
              </div>
            </div>
            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th style="width: 50px;"></th>
                    <th style="width: 60px;">Satır</th>
                    <th>Poliçe No</th>
                    <th>Sigortalı</th>
                    <th>TC/VKN</th>
                    <th>Ürün</th>
                    <th style="width: 90px;">Başlangıç</th>
                    <th style="width: 90px;">Bitiş</th>
                    <th style="width: 110px; text-align: right; white-space: nowrap;">Brüt Prim</th>
                    <th style="width: 70px;">Tip</th>
                    <th style="width: 120px;">Durum</th>
                  </tr>
                </thead>
                <tbody id="previewTableBody">
                </tbody>
              </table>
            </div>
            <div class="card-footer">
              <div class="footer-info">
                <span class="text-muted" id="totalRowsInfo">Toplam 0 satır okundu</span>
              </div>
              <!-- Pagination -->
              <div class="pagination" id="paginationContainer">
                <button class="pagination-btn" id="prevPageBtn" disabled>
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="15,18 9,12 15,6"/>
                  </svg>
                </button>
                <div class="pagination-pages" id="paginationPages">
                  <!-- Page buttons will be rendered here -->
                </div>
                <button class="pagination-btn" id="nextPageBtn">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="9,18 15,12 9,6"/>
                  </svg>
                </button>
                <span class="pagination-info" id="paginationInfo">Sayfa 1 / 1</span>
              </div>
              <div class="footer-actions">
                <button class="btn btn-secondary" id="cancelBtn">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                  </svg>
                  İptal
                </button>
                <button class="btn btn-primary" id="confirmBtn">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="20,6 9,17 4,12"/>
                  </svg>
                  <span id="confirmBtnText">0 Geçerli Kaydı İçeri Aktar</span>
                </button>
              </div>
            </div>
          </div>

          <!-- Step 3: Result Card -->
          <div class="card" id="resultCard" style="display: none;">
            <div class="card-header">
              <h3 class="card-title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 11.08V12a10 10 0 11-5.93-9.14"/>
                  <polyline points="22,4 12,14.01 9,11.01"/>
                </svg>
                Aktarım Tamamlandı
              </h3>
            </div>
            <div class="card-body">
              <!-- Result Stats -->
              <div class="result-stats">
                <div class="result-stat primary">
                  <div class="result-stat-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                      <polyline points="14,2 14,8 20,8"/>
                    </svg>
                  </div>
                  <div class="result-stat-value" id="resultTotal">0</div>
                  <div class="result-stat-label">Toplam İşlenen</div>
                </div>
                <div class="result-stat success">
                  <div class="result-stat-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M22 11.08V12a10 10 0 11-5.93-9.14"/>
                      <polyline points="22,4 12,14.01 9,11.01"/>
                    </svg>
                  </div>
                  <div class="result-stat-value" id="resultSuccess">0</div>
                  <div class="result-stat-label">Başarılı</div>
                </div>
                <div class="result-stat danger">
                  <div class="result-stat-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <circle cx="12" cy="12" r="10"/>
                      <line x1="15" y1="9" x2="9" y2="15"/>
                      <line x1="9" y1="9" x2="15" y2="15"/>
                    </svg>
                  </div>
                  <div class="result-stat-value" id="resultFailed">0</div>
                  <div class="result-stat-label">Hatalı</div>
                </div>
                <div class="result-stat warning">
                  <div class="result-stat-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                      <line x1="9" y1="9" x2="15" y2="15"/>
                      <line x1="15" y1="9" x2="9" y2="15"/>
                    </svg>
                  </div>
                  <div class="result-stat-value" id="resultDuplicate">0</div>
                  <div class="result-stat-label">Tekrar (Mükerrer)</div>
                </div>
              </div>

              <!-- New Customers Info -->
              <div class="info-banner" id="newCustomersInfo" style="display: none;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/>
                  <circle cx="8.5" cy="7" r="4"/>
                  <line x1="20" y1="8" x2="20" y2="14"/>
                  <line x1="23" y1="11" x2="17" y2="11"/>
                </svg>
                <span id="newCustomersText"></span>
              </div>

              <!-- Errors Section -->
              <div class="errors-section" id="resultErrors" style="display: none;">
                <div class="errors-header">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="8" x2="12" y2="12"/>
                    <line x1="12" y1="16" x2="12.01" y2="16"/>
                  </svg>
                  <span>Hatalı Satırlar</span>
                </div>
                <div class="table-container">
                  <table class="data-table">
                    <thead>
                      <tr>
                        <th style="width: 80px;">Satır</th>
                        <th style="width: 150px;">Poliçe No</th>
                        <th>Hata Mesajı</th>
                      </tr>
                    </thead>
                    <tbody id="errorTableBody">
                    </tbody>
                  </table>
                </div>
              </div>

              <!-- Detailed Import Report -->
              <div class="import-report-section" id="importReportSection">
                <div class="report-header">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                    <polyline points="14,2 14,8 20,8"/>
                    <line x1="16" y1="13" x2="8" y2="13"/>
                    <line x1="16" y1="17" x2="8" y2="17"/>
                  </svg>
                  <span>Aktarım Raporu</span>
                </div>

                <!-- Type Summary -->
                <div class="report-summary-row" id="reportTypeSummary">
                  <!-- Will be populated by JS -->
                </div>

                <!-- Prim Summary -->
                <div class="report-prim-section" id="reportPrimSection">
                  <!-- Will be populated by JS -->
                </div>

                <!-- Branch Breakdown -->
                <div class="report-branch-section" id="reportBranchSection">
                  <!-- Will be populated by JS -->
                </div>

                <!-- Date Breakdown -->
                <div class="report-date-section" id="reportDateSection">
                  <!-- Will be populated by JS -->
                </div>
              </div>

              <!-- Result Actions -->
              <div class="result-actions">
                <button class="btn btn-primary" id="newImportBtn">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 5v14M5 12h14"/>
                  </svg>
                  Yeni Aktarım
                </button>
                <a href="pool.html" class="btn btn-secondary">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                    <polyline points="14,2 14,8 20,8"/>
                  </svg>
                  Poliçe Havuzuna Git
                </a>
              </div>
            </div>
          </div>

        </div>
      </div>
    </main>
  </div>

  <!-- Row Detail Modal -->
  <div class="modal-overlay" id="rowDetailModal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">Poliçe Detayı</h3>
        <button class="modal-close" onclick="closeRowDetailModal()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      <div class="modal-body" id="rowDetailContent">
        <!-- Content will be rendered here -->
      </div>
    </div>
  </div>

  <!-- Import Progress Modal -->
  <div class="modal-overlay" id="importProgressModal">
    <div class="modal progress-modal">
      <div class="progress-modal-content">
        <div class="progress-icon">
          <svg class="progress-spinner" width="60" height="60" viewBox="0 0 50 50">
            <circle cx="25" cy="25" r="20" fill="none" stroke="var(--border-subtle)" stroke-width="4"/>
            <circle cx="25" cy="25" r="20" fill="none" stroke="var(--primary)" stroke-width="4"
                    stroke-dasharray="126" stroke-dashoffset="126" stroke-linecap="round"
                    class="progress-circle"/>
          </svg>
        </div>
        <h3 class="progress-title">Veriler Kaydediliyor</h3>
        <div class="progress-stats">
          <span class="progress-current" id="progressCurrent">0</span>
          <span class="progress-separator">/</span>
          <span class="progress-total" id="progressTotal">0</span>
        </div>
        <div class="progress-bar-container">
          <div class="progress-bar" id="progressBar"></div>
        </div>
        <p class="progress-message" id="progressMessage">Lütfen bekleyin...</p>
        <div class="progress-details" id="progressDetails">
          <span class="progress-detail-item success">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="20,6 9,17 4,12"/>
            </svg>
            <span id="progressSuccess">0</span> Başarılı
          </span>
          <span class="progress-detail-item duplicate">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" y1="8" x2="12" y2="12"/>
              <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
            <span id="progressDuplicate">0</span> Mükerrer
          </span>
          <span class="progress-detail-item failed">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="15" y1="9" x2="9" y2="15"/>
              <line x1="9" y1="9" x2="15" y2="15"/>
            </svg>
            <span id="progressFailed">0</span> Hatalı
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Floating Action Box - Import Summary -->
  <div class="floating-action-box" id="floatingActionBox">
    <div class="fab-header">
      <div class="fab-count">
        <span id="fabValidCount">0</span>
        <small>geçerli kayıt</small>
      </div>
      <button class="fab-close" onclick="hideFloatingBox()">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6L6 18M6 6l12 12"/>
        </svg>
      </button>
    </div>
    <div class="fab-stats">
      <div class="fab-stat">
        <span class="fab-stat-value" id="fabTotalPremium">0 TL</span>
        <span class="fab-stat-label">Toplam Brüt Prim</span>
      </div>
    </div>
    <div class="fab-actions">
      <button class="fab-btn fab-btn-primary" id="fabImportBtn" onclick="startImport()">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="20,6 9,17 4,12"/>
        </svg>
        <span id="fabImportBtnText">İçeri Aktar</span>
      </button>
      <button class="fab-btn fab-btn-secondary" onclick="showDetailModal()">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
          <circle cx="12" cy="12" r="3"/>
        </svg>
        Detayları Gör
      </button>
    </div>
  </div>

  <!-- Import Detail Modal -->
  <div class="modal-overlay" id="importDetailModal">
    <div class="modal import-detail-modal">
      <div class="modal-header">
        <h3 class="modal-title">İçeri Aktarma Özeti</h3>
        <button class="modal-close" onclick="closeDetailModal()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      <div class="modal-body" id="importDetailContent">
        <!-- Content will be rendered here -->
      </div>
    </div>
  </div>

  <script src="../../assets/js/config.js"></script>
  <script src="../../assets/js/app.js"></script>

  <style>
    /* ═══════════════════════════════════════════════════════════════
       WIZARD STEPS
       ═══════════════════════════════════════════════════════════════ */
    .wizard-steps {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0;
      padding: 1.5rem 2rem;
      background: var(--bg-surface);
      border-radius: var(--radius-lg);
      margin-bottom: 1.5rem;
      border: 1px solid var(--border-subtle);
    }

    .wizard-step {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.5rem 1rem;
      opacity: 0.5;
      transition: all var(--transition-base);
    }

    .wizard-step.active {
      opacity: 1;
    }

    .wizard-step.completed {
      opacity: 1;
    }

    .wizard-step-number {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--bg-elevated);
      border: 2px solid var(--border-default);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.875rem;
      color: var(--text-muted);
      transition: all var(--transition-base);
      position: relative;
    }

    .wizard-step.active .wizard-step-number {
      background: var(--primary);
      border-color: var(--primary);
      color: white;
    }

    .wizard-step.completed .wizard-step-number {
      background: var(--success);
      border-color: var(--success);
      color: white;
    }

    .wizard-step-number .step-num {
      display: block;
    }

    .wizard-step-number .step-check {
      display: none;
    }

    .wizard-step.completed .wizard-step-number .step-num {
      display: none;
    }

    .wizard-step.completed .wizard-step-number .step-check {
      display: block;
    }

    .wizard-step-content {
      display: flex;
      flex-direction: column;
    }

    .wizard-step-title {
      font-weight: 600;
      font-size: 0.875rem;
      color: var(--text-primary);
    }

    .wizard-step-desc {
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .wizard-connector {
      width: 60px;
      height: 2px;
      background: var(--border-default);
      margin: 0 0.5rem;
      transition: background var(--transition-base);
    }

    .wizard-step.completed + .wizard-connector {
      background: var(--success);
    }

    /* ═══════════════════════════════════════════════════════════════
       FORM ELEMENTS
       ═══════════════════════════════════════════════════════════════ */
    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-label {
      display: block;
      font-weight: 600;
      font-size: 0.875rem;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
    }

    .form-select {
      width: 100%;
      padding: 0.75rem 1rem;
      background: var(--bg-surface);
      border: 1px solid var(--border-default);
      border-radius: var(--radius-md);
      font-family: var(--font-sans);
      font-size: 0.875rem;
      color: var(--text-primary);
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .form-select:hover {
      border-color: var(--primary);
    }

    .form-select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px var(--primary-glow);
    }

    .form-hint {
      display: block;
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 0.5rem;
    }

    /* Detection Result */
    .detection-result {
      margin-top: 0.75rem;
    }

    .detection-success,
    .detection-warning {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      border-radius: var(--radius-md);
      font-size: 0.8125rem;
      font-weight: 500;
    }

    .detection-success {
      background: var(--success-glow);
      border: 1px solid var(--success);
      color: var(--success);
    }

    .detection-success strong {
      color: var(--text-primary);
      font-weight: 600;
    }

    .detection-warning {
      background: var(--warning-glow);
      border: 1px solid var(--warning);
      color: var(--warning);
    }

    .detection-mismatch {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      border-radius: var(--radius-md);
      font-size: 0.8125rem;
      font-weight: 500;
      background: rgba(251, 191, 36, 0.1);
      border: 1px solid #f59e0b;
      color: #f59e0b;
    }

    .detection-mismatch strong {
      color: var(--text-primary);
      font-weight: 600;
    }

    /* ═══════════════════════════════════════════════════════════════
       UPLOAD DROPZONE
       ═══════════════════════════════════════════════════════════════ */
    .upload-dropzone {
      position: relative;
      border: 2px dashed var(--border-default);
      border-radius: var(--radius-lg);
      background: var(--bg-elevated);
      transition: all var(--transition-base);
      overflow: hidden;
    }

    .upload-dropzone:hover,
    .upload-dropzone.dragover {
      border-color: var(--primary);
      background: var(--primary-glow);
    }

    .upload-dropzone input[type="file"] {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
      z-index: 2;
    }

    .dropzone-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 3rem 2rem;
      text-align: center;
      pointer-events: none;
    }

    .dropzone-icon {
      width: 72px;
      height: 72px;
      border-radius: 50%;
      background: var(--primary-glow);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 1rem;
      color: var(--primary);
    }

    .dropzone-text {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
      margin-bottom: 1rem;
    }

    .dropzone-title {
      font-weight: 600;
      font-size: 1rem;
      color: var(--text-primary);
    }

    .dropzone-subtitle {
      font-size: 0.875rem;
      color: var(--text-muted);
    }

    .dropzone-formats {
      display: flex;
      gap: 0.5rem;
    }

    .format-badge {
      padding: 0.25rem 0.75rem;
      background: var(--bg-surface);
      border: 1px solid var(--border-default);
      border-radius: var(--radius-sm);
      font-size: 0.75rem;
      font-weight: 500;
      color: var(--text-muted);
      font-family: var(--font-mono);
    }

    /* Selected File State */
    .dropzone-selected {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1.25rem 1.5rem;
      background: var(--success-glow);
      border-top: 1px solid var(--success);
    }

    .selected-file-icon {
      width: 48px;
      height: 48px;
      border-radius: var(--radius-md);
      background: var(--success);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
    }

    .selected-file-info {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .selected-file-name {
      font-weight: 600;
      color: var(--text-primary);
    }

    .selected-file-size {
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .selected-file-remove {
      width: 32px;
      height: 32px;
      border-radius: var(--radius-sm);
      background: transparent;
      border: 1px solid var(--border-default);
      color: var(--text-muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--transition-fast);
      position: relative;
      z-index: 3;
    }

    .selected-file-remove:hover {
      background: var(--danger);
      border-color: var(--danger);
      color: white;
    }

    .upload-dropzone.has-file .dropzone-content {
      display: none;
    }

    .upload-dropzone.has-file input[type="file"] {
      pointer-events: none;
    }

    /* ═══════════════════════════════════════════════════════════════
       SUPPORTED FORMATS
       ═══════════════════════════════════════════════════════════════ */
    .supported-formats {
      margin-top: 1.5rem;
      padding: 1rem;
      background: var(--bg-elevated);
      border-radius: var(--radius-md);
    }

    .formats-header {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 600;
      font-size: 0.8125rem;
      color: var(--text-primary);
      margin-bottom: 0.75rem;
    }

    .formats-header svg {
      color: var(--info);
    }

    .formats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 0.75rem;
    }

    @media (max-width: 992px) {
      .formats-grid {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    @media (max-width: 768px) {
      .formats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .format-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem;
      background: var(--bg-surface);
      border-radius: var(--radius-md);
      border: 1px solid var(--border-subtle);
      transition: all 0.2s ease;
    }

    .format-item:hover {
      border-color: var(--primary-light);
      background: var(--bg-elevated);
      transform: translateY(-2px);
    }

    .format-logo {
      width: 48px;
      height: 48px;
      border-radius: var(--radius-sm);
      object-fit: contain;
      background: white;
      padding: 4px;
    }

    .format-logo-placeholder {
      width: 48px;
      height: 48px;
      border-radius: var(--radius-sm);
      background: var(--bg-elevated);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--text-muted);
    }

    .format-name {
      font-size: 0.75rem;
      color: var(--text-secondary);
      text-align: center;
      font-weight: 500;
    }

    /* ═══════════════════════════════════════════════════════════════
       UPLOAD ACTIONS
       ═══════════════════════════════════════════════════════════════ */
    .upload-actions {
      margin-top: 1.5rem;
      display: flex;
      justify-content: flex-end;
    }

    .btn-lg {
      padding: 0.875rem 1.5rem;
      font-size: 0.9375rem;
    }

    /* ═══════════════════════════════════════════════════════════════
       LOADING STATE
       ═══════════════════════════════════════════════════════════════ */
    .loading-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 4rem 2rem;
      text-align: center;
    }

    /* Windows 10/11 style Ring Spinner */
    .windows-spinner {
      width: 48px;
      height: 48px;
      margin-bottom: 1.5rem;
      border: 4px solid rgba(99, 102, 241, 0.2);
      border-top-color: #6366f1;
      border-radius: 50%;
      will-change: transform;
      -webkit-animation: spinner-rotate 1s linear infinite;
      -moz-animation: spinner-rotate 1s linear infinite;
      -o-animation: spinner-rotate 1s linear infinite;
      animation: spinner-rotate 1s linear infinite;
    }

    @-webkit-keyframes spinner-rotate {
      0% { -webkit-transform: rotate(0deg); }
      100% { -webkit-transform: rotate(360deg); }
    }

    @-moz-keyframes spinner-rotate {
      0% { -moz-transform: rotate(0deg); }
      100% { -moz-transform: rotate(360deg); }
    }

    @-o-keyframes spinner-rotate {
      0% { -o-transform: rotate(0deg); }
      100% { -o-transform: rotate(360deg); }
    }

    @keyframes spinner-rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .loading-text {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }

    .loading-title {
      font-weight: 600;
      font-size: 1rem;
      color: var(--text-primary);
    }

    .loading-subtitle {
      font-size: 0.875rem;
      color: var(--text-muted);
    }

    /* ═══════════════════════════════════════════════════════════════
       PREVIEW TABLE
       ═══════════════════════════════════════════════════════════════ */
    .status-pill {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      padding: 0.35rem 0.75rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .status-pill.success {
      background: var(--success-glow);
      color: var(--success);
    }

    .status-pill.danger {
      background: var(--danger-glow);
      color: var(--danger);
    }

    .row-error {
      background: var(--danger-bg) !important;
    }

    .status-badge-sm {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      padding: 0.25rem 0.5rem;
      border-radius: var(--radius-sm);
      font-size: 0.6875rem;
      font-weight: 500;
    }

    .status-badge-sm.success {
      background: var(--success-glow);
      color: var(--success);
    }

    .status-badge-sm.danger {
      background: var(--danger-glow);
      color: var(--danger);
    }

    /* Zeyil/Yeni Badge Styles */
    .badge-warning {
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.15) 0%, rgba(217, 119, 6, 0.15) 100%);
      color: #f59e0b;
      border: 1px solid rgba(245, 158, 11, 0.3);
    }

    .badge-success {
      background: linear-gradient(135deg, rgba(34, 197, 94, 0.15) 0%, rgba(22, 163, 74, 0.15) 100%);
      color: #22c55e;
      border: 1px solid rgba(34, 197, 94, 0.3);
    }

    .badge-danger {
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.15) 0%, rgba(220, 38, 38, 0.15) 100%);
      color: #ef4444;
      border: 1px solid rgba(239, 68, 68, 0.3);
    }

    .card-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem 1.5rem;
      border-top: 1px solid var(--border-subtle);
      background: var(--bg-elevated);
      flex-wrap: wrap;
      gap: 1rem;
    }

    .footer-actions {
      display: flex;
      gap: 0.75rem;
    }

    /* Pagination Styles */
    .pagination {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .pagination-btn {
      width: 32px;
      height: 32px;
      border-radius: var(--radius-sm);
      background: var(--bg-surface);
      border: 1px solid var(--border-default);
      color: var(--text-secondary);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--transition-fast);
    }

    .pagination-btn:hover:not(:disabled) {
      background: var(--primary-glow);
      border-color: var(--primary);
      color: var(--primary);
    }

    .pagination-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .pagination-pages {
      display: flex;
      gap: 0.25rem;
    }

    .pagination-page {
      min-width: 32px;
      height: 32px;
      padding: 0 0.5rem;
      border-radius: var(--radius-sm);
      background: var(--bg-surface);
      border: 1px solid var(--border-default);
      color: var(--text-secondary);
      font-size: 0.8125rem;
      font-weight: 500;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--transition-fast);
    }

    .pagination-page:hover {
      background: var(--primary-glow);
      border-color: var(--primary);
      color: var(--primary);
    }

    .pagination-page.active {
      background: var(--primary);
      border-color: var(--primary);
      color: white;
    }

    .pagination-ellipsis {
      min-width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-muted);
      font-size: 0.8125rem;
    }

    .pagination-info {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-left: 0.5rem;
    }

    /* ═══════════════════════════════════════════════════════════════
       RESULT STATS
       ═══════════════════════════════════════════════════════════════ */
    .result-stats {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .result-stat {
      padding: 1.5rem;
      background: var(--bg-elevated);
      border-radius: var(--radius-lg);
      text-align: center;
      border: 1px solid var(--border-subtle);
    }

    .result-stat-icon {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      margin: 0 auto 0.75rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .result-stat.primary .result-stat-icon {
      background: var(--primary-glow);
      color: var(--primary);
    }

    .result-stat.success .result-stat-icon {
      background: var(--success-glow);
      color: var(--success);
    }

    .result-stat.danger .result-stat-icon {
      background: var(--danger-glow);
      color: var(--danger);
    }

    .result-stat.warning .result-stat-icon {
      background: var(--warning-glow);
      color: var(--warning);
    }

    .result-stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--text-primary);
      line-height: 1;
      margin-bottom: 0.25rem;
    }

    .result-stat-label {
      font-size: 0.8125rem;
      color: var(--text-muted);
    }

    /* Info Banner */
    .info-banner {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 1rem 1.25rem;
      background: var(--info-glow);
      border-radius: var(--radius-md);
      color: var(--info);
      font-size: 0.875rem;
      font-weight: 500;
      margin-bottom: 1.5rem;
    }

    /* Errors Section */
    .errors-section {
      margin-bottom: 1.5rem;
    }

    .errors-header {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 600;
      font-size: 0.875rem;
      color: var(--danger);
      margin-bottom: 0.75rem;
    }

    /* Result Actions */
    .result-actions {
      display: flex;
      gap: 0.75rem;
    }

    /* ═══════════════════════════════════════════════════════════════
       ROW DETAIL BUTTON
       ═══════════════════════════════════════════════════════════════ */
    .btn-icon {
      width: 32px;
      height: 32px;
      border-radius: var(--radius-sm);
      background: transparent;
      border: 1px solid var(--border-default);
      color: var(--text-muted);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      transition: all var(--transition-fast);
    }

    .btn-icon:hover {
      background: var(--primary-glow);
      border-color: var(--primary);
      color: var(--primary);
    }

    /* ═══════════════════════════════════════════════════════════════
       MODAL STYLES - Modern Glass Effect
       ═══════════════════════════════════════════════════════════════ */

    /* Body scroll lock when modal is open */
    body.modal-open {
      overflow: hidden;
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(10, 15, 30, 0.6);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 1.5rem;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .modal {
      background: linear-gradient(145deg, rgba(30, 35, 55, 0.95) 0%, rgba(20, 25, 45, 0.98) 100%);
      border: 1px solid rgba(99, 102, 241, 0.15);
      border-radius: 20px;
      box-shadow:
        0 0 0 1px rgba(255, 255, 255, 0.05),
        0 25px 50px -12px rgba(0, 0, 0, 0.5),
        0 0 100px rgba(99, 102, 241, 0.1);
      max-height: 85vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      width: 100%;
      max-width: 640px;
      transform: scale(0.9) translateY(30px);
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .modal-overlay.active .modal {
      transform: scale(1) translateY(0);
    }

    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1.25rem 1.5rem;
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.05) 100%);
      border-bottom: 1px solid rgba(99, 102, 241, 0.1);
    }

    .modal-title {
      font-size: 1.125rem;
      font-weight: 600;
      color: #fff;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .modal-title::before {
      content: '';
      width: 4px;
      height: 20px;
      background: linear-gradient(180deg, #6366f1 0%, #8b5cf6 100%);
      border-radius: 2px;
    }

    .modal-close {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: rgba(255, 255, 255, 0.6);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }

    .modal-close:hover {
      background: rgba(239, 68, 68, 0.15);
      border-color: rgba(239, 68, 68, 0.3);
      color: #ef4444;
      transform: rotate(90deg);
    }

    .modal-body {
      padding: 1.5rem;
      overflow-y: auto;
      max-height: calc(85vh - 70px);
    }

    .modal-body::-webkit-scrollbar {
      width: 6px;
    }

    .modal-body::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.02);
      border-radius: 3px;
    }

    .modal-body::-webkit-scrollbar-thumb {
      background: rgba(99, 102, 241, 0.3);
      border-radius: 3px;
    }

    .modal-body::-webkit-scrollbar-thumb:hover {
      background: rgba(99, 102, 241, 0.5);
    }

    /* Detail Section */
    .detail-section {
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      padding: 1.25rem;
      margin-bottom: 1rem;
    }

    .detail-section:last-child {
      margin-bottom: 0;
    }

    .detail-section-title {
      font-size: 0.75rem;
      font-weight: 600;
      color: #6366f1;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .detail-section-title svg {
      opacity: 0.8;
    }

    /* Detail Grid */
    .detail-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
    }

    .detail-group {
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
    }

    .detail-group.full-width {
      grid-column: span 2;
    }

    .detail-label {
      font-size: 0.6875rem;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.4);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .detail-value {
      font-size: 0.9375rem;
      color: rgba(255, 255, 255, 0.9);
      font-weight: 500;
    }

    .detail-value.mono {
      font-family: var(--font-mono);
      color: #a5b4fc;
    }

    .detail-value.empty {
      color: rgba(255, 255, 255, 0.25);
      font-style: italic;
      font-weight: 400;
    }

    /* Modal Badges */
    .modal .badge {
      display: inline-flex;
      align-items: center;
      padding: 0.35rem 0.75rem;
      border-radius: 6px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .modal .badge-success {
      background: rgba(34, 197, 94, 0.15);
      color: #4ade80;
      border: 1px solid rgba(34, 197, 94, 0.25);
    }

    .modal .badge-warning {
      background: rgba(245, 158, 11, 0.15);
      color: #fbbf24;
      border: 1px solid rgba(245, 158, 11, 0.25);
    }

    .modal .badge-danger {
      background: rgba(239, 68, 68, 0.15);
      color: #f87171;
      border: 1px solid rgba(239, 68, 68, 0.25);
    }

    /* Validation Errors in Modal */
    .detail-errors {
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(220, 38, 38, 0.05) 100%);
      border: 1px solid rgba(239, 68, 68, 0.2);
      border-radius: 12px;
      padding: 1rem 1.25rem;
      margin-top: 1rem;
    }

    .detail-errors-title {
      font-size: 0.75rem;
      font-weight: 600;
      color: #f87171;
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .detail-errors-title::before {
      content: '\26A0';
      font-size: 0.875rem;
    }

    .detail-errors-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .detail-errors-list li {
      font-size: 0.8125rem;
      color: rgba(248, 113, 113, 0.9);
      padding: 0.375rem 0;
      padding-left: 1rem;
      position: relative;
    }

    .detail-errors-list li::before {
      content: '\2022';
      position: absolute;
      left: 0;
      color: #f87171;
    }

    /* Detail Header Card */
    .detail-header-card {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(139, 92, 246, 0.1) 100%);
      border: 1px solid rgba(99, 102, 241, 0.2);
      border-radius: 14px;
      padding: 1.25rem;
      margin-bottom: 1rem;
    }

    .detail-header-main {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .detail-header-icon {
      width: 48px;
      height: 48px;
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
    }

    .detail-header-info {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }

    .detail-header-no {
      font-size: 1.25rem;
      font-weight: 700;
      color: #fff;
      font-family: var(--font-mono);
      letter-spacing: 0.025em;
    }

    .detail-header-brans {
      font-size: 0.8125rem;
      color: rgba(255, 255, 255, 0.6);
    }

    .detail-header-badges {
      display: flex;
      gap: 0.5rem;
    }

    /* Prim Cards */
    .detail-prim-cards {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 0.75rem;
      margin-bottom: 1rem;
    }

    .prim-card {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 12px;
      padding: 1rem;
      text-align: center;
      transition: all 0.2s ease;
    }

    .prim-card:hover {
      background: rgba(255, 255, 255, 0.05);
      transform: translateY(-2px);
    }

    .prim-label {
      display: block;
      font-size: 0.6875rem;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.4);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.5rem;
    }

    .prim-value {
      display: block;
      font-size: 1.125rem;
      font-weight: 700;
      font-family: var(--font-mono);
    }

    .prim-brut .prim-value {
      color: #a5b4fc;
    }

    .prim-net .prim-value {
      color: #4ade80;
    }

    .prim-komisyon .prim-value {
      color: #fbbf24;
    }

    /* ═══════════════════════════════════════════════════════════════
       PROGRESS MODAL
       ═══════════════════════════════════════════════════════════════ */
    .progress-modal {
      max-width: 420px;
      padding: 2.5rem;
      text-align: center;
    }

    .progress-modal-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.25rem;
    }

    .progress-icon {
      position: relative;
    }

    .progress-spinner {
      animation: rotate 2s linear infinite;
    }

    .progress-circle {
      animation: dash 1.5s ease-in-out infinite;
    }

    @keyframes rotate {
      100% { transform: rotate(360deg); }
    }

    @keyframes dash {
      0% { stroke-dashoffset: 126; }
      50% { stroke-dashoffset: 30; }
      100% { stroke-dashoffset: 126; }
    }

    .progress-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: #ffffff;
      margin: 0;
    }

    .progress-stats {
      display: flex;
      align-items: baseline;
      gap: 0.25rem;
      font-family: var(--font-mono);
    }

    .progress-current {
      font-size: 2rem;
      font-weight: 700;
      color: #818cf8;
    }

    .progress-separator {
      font-size: 1.5rem;
      color: rgba(255, 255, 255, 0.5);
    }

    .progress-total {
      font-size: 1.5rem;
      font-weight: 600;
      color: rgba(255, 255, 255, 0.8);
    }

    .progress-bar-container {
      width: 100%;
      height: 8px;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 4px;
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #6366f1, #818cf8);
      border-radius: 4px;
      transition: width 0.3s ease;
    }

    .progress-message {
      font-size: 0.875rem;
      color: rgba(255, 255, 255, 0.6);
      margin: 0;
    }

    .progress-details {
      display: flex;
      gap: 1.5rem;
      margin-top: 0.5rem;
    }

    .progress-detail-item {
      display: flex;
      align-items: center;
      gap: 0.375rem;
      font-size: 0.8125rem;
      font-family: var(--font-mono);
    }

    .progress-detail-item.success {
      color: #4ade80;
    }

    .progress-detail-item.success svg {
      stroke: #4ade80;
    }

    .progress-detail-item.duplicate {
      color: #fbbf24;
    }

    .progress-detail-item.duplicate svg {
      stroke: #fbbf24;
    }

    .progress-detail-item.failed {
      color: #f87171;
    }

    .progress-detail-item.failed svg {
      stroke: #f87171;
    }

    /* ═══════════════════════════════════════════════════════════════
       FLOATING ACTION BOX
       ═══════════════════════════════════════════════════════════════ */
    .floating-action-box {
      position: fixed;
      right: -300px;
      top: 50%;
      transform: translateY(-50%);
      width: 260px;
      background: #1a1b23;
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-right: none;
      border-radius: 16px 0 0 16px;
      padding: 1.5rem;
      z-index: 500;
      transition: right 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: -8px 0 32px rgba(0, 0, 0, 0.4);
    }

    .floating-action-box.active {
      right: 0;
    }

    .fab-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      margin-bottom: 1.25rem;
    }

    .fab-count {
      display: flex;
      flex-direction: column;
      gap: 0.125rem;
    }

    .fab-count span {
      font-size: 2.5rem;
      font-weight: 800;
      color: #fff;
      line-height: 1;
      letter-spacing: -0.02em;
    }

    .fab-count small {
      font-size: 0.8rem;
      color: #6b7280;
      font-weight: 500;
    }

    .fab-close {
      width: 28px;
      height: 28px;
      border: none;
      background: transparent;
      border-radius: 6px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #6b7280;
      transition: all 0.15s ease;
    }

    .fab-close:hover {
      background: rgba(239, 68, 68, 0.15);
      color: #ef4444;
    }

    .fab-stats {
      margin-bottom: 1.25rem;
      padding: 1rem;
      background: rgba(99, 102, 241, 0.1);
      border-radius: 12px;
      border: 1px solid rgba(99, 102, 241, 0.15);
    }

    .fab-stat {
      text-align: center;
    }

    .fab-stat-value {
      display: block;
      font-size: 1.5rem;
      font-weight: 700;
      color: #a5b4fc;
      letter-spacing: -0.01em;
    }

    .fab-stat-label {
      display: block;
      font-size: 0.7rem;
      color: #6b7280;
      margin-top: 0.25rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 600;
    }

    .fab-status-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 0.5rem;
      margin-bottom: 1.25rem;
    }

    .fab-status-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0.75rem 0.5rem;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .fab-status-item svg {
      margin-bottom: 0.25rem;
    }

    .fab-status-item span {
      font-size: 1.25rem;
      font-weight: 700;
      color: #fff;
      line-height: 1;
    }

    .fab-status-item small {
      font-size: 0.65rem;
      color: #6b7280;
      margin-top: 0.25rem;
    }

    .fab-status-item.success svg {
      color: #10b981;
    }

    .fab-status-item.success span {
      color: #10b981;
    }

    .fab-status-item.duplicate svg {
      color: #f59e0b;
    }

    .fab-status-item.duplicate span {
      color: #f59e0b;
    }

    .fab-status-item.failed svg {
      color: #ef4444;
    }

    .fab-status-item.failed span {
      color: #ef4444;
    }

    .fab-actions {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .fab-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      border-radius: 10px;
      font-size: 0.8rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s ease;
      border: none;
    }

    .fab-btn svg {
      flex-shrink: 0;
      width: 16px;
      height: 16px;
    }

    .fab-btn-primary {
      background: #10b981;
      color: #fff;
    }

    .fab-btn-primary:hover {
      background: #059669;
      transform: translateY(-1px);
    }

    .fab-btn-primary:disabled {
      background: #374151;
      color: #6b7280;
      cursor: not-allowed;
      transform: none;
    }

    .fab-btn-secondary {
      background: #374151;
      color: #e5e7eb;
    }

    .fab-btn-secondary:hover {
      background: #4b5563;
    }

    /* ═══════════════════════════════════════════════════════════════
       IMPORT DETAIL MODAL
       ═══════════════════════════════════════════════════════════════ */
    .import-detail-modal {
      max-width: 700px;
      width: 95%;
    }

    .import-detail-modal .modal-body {
      max-height: 70vh;
      overflow-y: auto;
    }

    .detail-summary-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .detail-summary-card {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 12px;
      padding: 1rem;
      text-align: center;
    }

    .detail-summary-card .value {
      font-size: 2rem;
      font-weight: 800;
      color: #fff;
      line-height: 1;
    }

    .detail-summary-card .label {
      font-size: 0.75rem;
      color: #9ca3af;
      margin-top: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .detail-summary-card.zeyil .value { color: #f59e0b; }
    .detail-summary-card.police .value { color: #6366f1; }
    .detail-summary-card.yeni .value { color: #10b981; }

    /* Modal Branch Layout */
    .modal-branch-layout {
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
    }

    .modal-chart-row {
      display: flex;
      gap: 1.5rem;
      align-items: center;
      padding: 1rem;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 12px;
    }

    .modal-branch-legend {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.375rem 0;
    }

    .legend-color {
      width: 10px;
      height: 10px;
      border-radius: 3px;
      flex-shrink: 0;
    }

    .legend-text {
      flex: 1;
      font-size: 0.8rem;
      color: #e2e8f0;
    }

    .legend-value {
      font-size: 0.8rem;
      color: #94a3b8;
      font-family: 'SF Mono', 'Fira Code', monospace;
    }

    /* Modal Branch Table */
    .modal-branch-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
      margin-top: 1rem;
    }

    .modal-branch-table th {
      text-align: left;
      padding: 0.75rem 1rem;
      background: rgba(255, 255, 255, 0.05);
      color: #94a3b8;
      font-weight: 600;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .modal-branch-table th:not(:first-child) {
      text-align: center;
    }

    .modal-branch-table th:last-child {
      text-align: right;
    }

    .modal-branch-table td {
      padding: 0.75rem 1rem;
      color: #e2e8f0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .modal-branch-table td:not(:first-child) {
      text-align: center;
    }

    .modal-branch-table td:last-child {
      text-align: right;
      font-family: 'SF Mono', 'Fira Code', monospace;
      color: #a5b4fc;
    }

    .modal-branch-table tr:hover {
      background: rgba(255, 255, 255, 0.03);
    }

    .branch-badge-sm {
      display: inline-block;
      padding: 0.25rem 0.5rem;
      background: rgba(99, 102, 241, 0.15);
      color: #c7d2fe;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .count-yeni {
      color: #34d399;
      font-weight: 600;
    }

    .count-zeyil {
      color: #fbbf24;
      font-weight: 600;
    }

    .detail-section {
      margin-bottom: 1.5rem;
    }

    .detail-section-title {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.85rem;
      font-weight: 600;
      color: #e5e7eb;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .detail-section-title svg {
      width: 16px;
      height: 16px;
      color: #6366f1;
    }

    .prim-detail-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 0.75rem;
    }

    .prim-detail-card {
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 10px;
      padding: 0.875rem;
    }

    .prim-detail-card .prim-type {
      font-size: 0.7rem;
      color: #6b7280;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.25rem;
    }

    .prim-detail-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.375rem 0;
      font-size: 0.8rem;
    }

    .prim-detail-row:not(:last-child) {
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .prim-detail-row .label {
      color: #9ca3af;
    }

    .prim-detail-row .value {
      font-weight: 600;
      font-family: 'SF Mono', 'Fira Code', monospace;
    }

    .prim-detail-row .value.positive { color: #10b981; }
    .prim-detail-row .value.negative { color: #ef4444; }
    .prim-detail-row .value.total { color: #a5b4fc; font-weight: 700; }

    .branch-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.8rem;
    }

    .branch-table th {
      text-align: left;
      padding: 0.75rem 0.5rem;
      color: #9ca3af;
      font-weight: 600;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .branch-table th:not(:first-child) {
      text-align: right;
    }

    .branch-table td {
      padding: 0.625rem 0.5rem;
      color: #e5e7eb;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .branch-table td:not(:first-child) {
      text-align: right;
      font-family: 'SF Mono', 'Fira Code', monospace;
    }

    .branch-table tr:last-child td {
      border-bottom: none;
    }

    .branch-table .branch-name {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .branch-table .branch-badge {
      padding: 0.25rem 0.5rem;
      background: rgba(99, 102, 241, 0.15);
      color: #a5b4fc;
      border-radius: 4px;
      font-size: 0.7rem;
      font-weight: 600;
    }

    .date-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.8rem;
    }

    .date-table th {
      text-align: left;
      padding: 0.75rem 0.5rem;
      color: #9ca3af;
      font-weight: 600;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .date-table th:not(:first-child) {
      text-align: right;
    }

    .date-table td {
      padding: 0.625rem 0.5rem;
      color: #e5e7eb;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .date-table td:not(:first-child) {
      text-align: right;
      font-family: 'SF Mono', 'Fira Code', monospace;
    }

    .date-table tr:last-child td {
      border-bottom: none;
    }

    /* ═══════════════════════════════════════════════════════════════
       IMPORT REPORT SECTION (Result Page) - Light Theme
       ═══════════════════════════════════════════════════════════════ */
    .import-report-section {
      margin-top: 2rem;
      padding: 1.75rem;
      background: var(--bg-surface);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-lg);
      box-shadow: var(--card-shadow);
    }

    .report-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-size: 1.125rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--border-subtle);
    }

    .report-header svg {
      color: var(--primary);
    }

    .report-summary-row {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .report-summary-item {
      background: var(--bg-surface);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md);
      padding: 1.5rem 1.25rem;
      text-align: center;
      transition: all var(--transition-fast);
      box-shadow: var(--shadow-sm);
    }

    .report-summary-item:hover {
      box-shadow: var(--shadow-md);
      transform: translateY(-2px);
    }

    .report-summary-item .value {
      font-size: 2.25rem;
      font-weight: 800;
      line-height: 1;
      letter-spacing: -0.02em;
    }

    .report-summary-item .label {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-weight: 600;
    }

    .report-summary-item.zeyil {
      border-left: 4px solid var(--warning);
      background: linear-gradient(135deg, var(--warning-bg) 0%, var(--bg-surface) 100%);
    }
    .report-summary-item.zeyil .value { color: var(--warning-dim); }

    .report-summary-item.police {
      border-left: 4px solid var(--primary);
      background: linear-gradient(135deg, var(--primary-glow) 0%, var(--bg-surface) 100%);
    }
    .report-summary-item.police .value { color: var(--primary); }

    .report-summary-item.yeni {
      border-left: 4px solid var(--success);
      background: linear-gradient(135deg, var(--success-bg) 0%, var(--bg-surface) 100%);
    }
    .report-summary-item.yeni .value { color: var(--success-dim); }

    .report-prim-section {
      margin-bottom: 1.75rem;
    }

    .report-prim-section h4,
    .report-branch-section h4,
    .report-date-section h4 {
      font-size: 0.8rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .report-prim-section h4::before,
    .report-branch-section h4::before,
    .report-date-section h4::before {
      content: '';
      width: 3px;
      height: 16px;
      background: linear-gradient(180deg, var(--primary-light) 0%, var(--primary) 100%);
      border-radius: 2px;
    }

    .report-prim-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
    }

    .report-prim-card {
      background: var(--bg-surface);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md);
      padding: 1.25rem;
      transition: all var(--transition-fast);
      box-shadow: var(--shadow-sm);
    }

    .report-prim-card:hover {
      box-shadow: var(--shadow-md);
      border-color: var(--primary-glow);
    }

    .report-prim-card .prim-title {
      font-size: 0.7rem;
      font-weight: 700;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 1rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid var(--border-subtle);
    }

    .report-prim-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem 0;
      font-size: 0.85rem;
    }

    .report-prim-row .label {
      color: var(--text-muted);
    }

    .report-prim-row .value {
      font-weight: 600;
      font-family: var(--font-mono);
    }

    .report-prim-row .value.positive { color: var(--success); }
    .report-prim-row .value.negative { color: var(--danger); }
    .report-prim-row.total {
      margin-top: 0.75rem;
      padding-top: 0.75rem;
      border-top: 1px solid var(--border-subtle);
    }
    .report-prim-row.total .label { color: var(--text-primary); font-weight: 600; }
    .report-prim-row.total .value { color: var(--primary); font-weight: 700; font-size: 1rem; }

    .report-branch-section,
    .report-date-section {
      margin-bottom: 1.75rem;
    }

    .report-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.8rem;
      background: var(--bg-surface);
      border-radius: var(--radius-md);
      overflow: hidden;
      border: 1px solid var(--border-subtle);
      box-shadow: var(--shadow-sm);
    }

    .report-table th {
      text-align: left;
      padding: 0.875rem 1rem;
      background: var(--bg-elevated);
      color: var(--text-muted);
      font-weight: 600;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .report-table th:not(:first-child) {
      text-align: right;
    }

    .report-table td {
      padding: 0.75rem 1rem;
      color: var(--text-primary);
      border-top: 1px solid var(--border-subtle);
    }

    .report-table tr:hover td {
      background: var(--primary-glow);
    }

    .report-table td:not(:first-child) {
      text-align: right;
      font-family: var(--font-mono);
    }

    .report-table .branch-badge {
      display: inline-block;
      padding: 0.35rem 0.75rem;
      background: linear-gradient(135deg, var(--primary-glow) 0%, var(--primary-intense) 100%);
      color: var(--primary);
      border-radius: 6px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    /* Branch Section Grid (Chart + Accordion) */
    .branch-section-grid {
      display: flex;
      flex-direction: column;
      gap: 1.75rem;
    }

    .branch-section-row {
      display: grid;
      grid-template-columns: 320px 1fr;
      gap: 1.5rem;
      align-items: start;
    }

    .branch-chart-container {
      background: var(--bg-surface);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md);
      padding: 1.5rem;
      box-shadow: var(--shadow-sm);
    }

    .branch-legend {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      justify-content: center;
    }

    .branch-legend-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1rem;
      background: var(--bg-elevated);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      transition: all var(--transition-fast);
    }

    .branch-legend-item:hover {
      background: var(--primary-glow);
      border-color: var(--primary);
      transform: translateX(4px);
    }

    .branch-legend-color {
      width: 14px;
      height: 14px;
      border-radius: 4px;
      flex-shrink: 0;
      box-shadow: var(--shadow-sm);
    }

    .branch-legend-name {
      flex: 1;
      font-size: 0.85rem;
      color: var(--text-primary);
      font-weight: 500;
    }

    .branch-legend-value {
      font-size: 0.85rem;
      color: var(--primary);
      font-family: var(--font-mono);
      font-weight: 600;
    }

    .branch-accordion-container {
      display: flex;
      flex-direction: column;
      gap: 0.875rem;
    }

    .accordion-title {
      font-size: 0.75rem;
      font-weight: 700;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin: 0 0 1rem 0;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid var(--border-subtle);
    }

    /* Branch Accordion */
    .branch-accordion-item {
      background: var(--bg-surface);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md);
      overflow: hidden;
      transition: all var(--transition-base);
      box-shadow: var(--shadow-sm);
    }

    .branch-accordion-item:hover {
      border-color: var(--primary-glow);
      box-shadow: var(--shadow-md);
    }

    .branch-accordion-item.open {
      border-color: var(--primary);
      box-shadow: var(--shadow-lg), 0 0 0 1px var(--primary-glow);
    }

    .branch-accordion-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1.125rem 1.5rem;
      cursor: pointer;
      transition: background var(--transition-fast);
      user-select: none;
    }

    .branch-accordion-header:hover {
      background: var(--primary-glow);
    }

    .branch-header-left {
      display: flex;
      align-items: center;
      gap: 1rem;
      min-width: 0;
    }

    .branch-expand-icon {
      font-size: 0.65rem;
      color: var(--text-muted);
      transition: transform 0.3s ease, color 0.3s ease;
      flex-shrink: 0;
    }

    .branch-accordion-item.open .branch-expand-icon {
      transform: rotate(90deg);
      color: var(--primary);
    }

    .branch-badge {
      display: inline-block;
      padding: 0.5rem 1.125rem;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      color: #fff;
      border-radius: 8px;
      font-size: 0.875rem;
      font-weight: 600;
      white-space: nowrap;
      box-shadow: 0 2px 8px rgba(99, 102, 241, 0.25);
    }

    .branch-header-stats {
      display: flex;
      gap: 2rem;
      align-items: center;
      flex-shrink: 0;
    }

    .branch-stat {
      font-size: 0.9rem;
      color: var(--text-secondary);
      font-family: var(--font-mono);
    }

    .branch-stat strong {
      color: var(--warning);
      font-weight: 700;
      font-size: 1rem;
    }

    .branch-accordion-content {
      display: grid;
      grid-template-rows: 0fr;
      transition: grid-template-rows 0.3s ease;
    }

    .branch-accordion-item.open .branch-accordion-content {
      grid-template-rows: 1fr;
    }

    .branch-accordion-inner {
      overflow: hidden;
    }

    .branch-breakdown-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
      padding: 0.5rem 1.5rem 1.5rem 3rem;
    }

    .branch-breakdown-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1.25rem;
      border-radius: var(--radius-md);
      border-left: 4px solid;
      transition: all var(--transition-fast);
    }

    .branch-breakdown-item.yeni {
      border-left-color: var(--success);
      background: linear-gradient(135deg, var(--success-bg) 0%, var(--bg-surface) 100%);
    }

    .branch-breakdown-item.yeni:hover {
      background: linear-gradient(135deg, var(--success-glow) 0%, var(--success-bg) 100%);
    }

    .branch-breakdown-item.zeyil {
      border-left-color: var(--warning);
      background: linear-gradient(135deg, var(--warning-bg) 0%, var(--bg-surface) 100%);
    }

    .branch-breakdown-item.zeyil:hover {
      background: linear-gradient(135deg, var(--warning-glow) 0%, var(--warning-bg) 100%);
    }

    .breakdown-icon {
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: var(--radius-sm);
      flex-shrink: 0;
    }

    .branch-breakdown-item.yeni .breakdown-icon {
      background: var(--success-glow);
      color: var(--success);
    }

    .branch-breakdown-item.zeyil .breakdown-icon {
      background: var(--warning-glow);
      color: var(--warning);
    }

    .breakdown-info {
      display: flex;
      flex-direction: column;
      gap: 0.375rem;
    }

    .breakdown-label {
      font-size: 0.7rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-muted);
    }

    .breakdown-value {
      font-size: 1.375rem;
      font-weight: 800;
      color: var(--text-primary);
    }

    .breakdown-prim {
      font-size: 0.95rem;
      font-family: var(--font-mono);
      font-weight: 600;
    }

    .branch-breakdown-item.yeni .breakdown-prim {
      color: var(--success);
    }

    .branch-breakdown-item.zeyil .breakdown-prim {
      color: var(--warning);
    }

    /* Date Chart Container */
    .date-chart-container {
      background: var(--bg-surface);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md);
      padding: 1.5rem;
      margin-bottom: 1.25rem;
      box-shadow: var(--shadow-sm);
    }

    .date-summary-row {
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
    }

    .date-summary-item {
      flex: 1;
      min-width: 120px;
      background: var(--bg-elevated);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.375rem;
      text-align: center;
      transition: all var(--transition-fast);
    }

    .date-summary-item:hover {
      border-color: var(--primary);
      background: var(--primary-glow);
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .date-label {
      font-size: 0.7rem;
      font-weight: 700;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .date-count {
      font-size: 1.125rem;
      font-weight: 800;
      color: var(--text-primary);
    }

    .date-prim {
      font-size: 0.85rem;
      color: var(--primary);
      font-family: var(--font-mono);
      font-weight: 600;
    }

    /* Custom ApexCharts Tooltip Styles */
    .apexcharts-tooltip {
      background: transparent !important;
      border: none !important;
      box-shadow: none !important;
    }

    .apexcharts-tooltip.apexcharts-theme-dark,
    .apexcharts-tooltip.apexcharts-theme-light {
      background: transparent !important;
    }

    .apex-tooltip-custom {
      background: var(--bg-surface);
      border: 1px solid var(--primary);
      border-radius: var(--radius-md);
      padding: 12px 16px;
      box-shadow: var(--shadow-lg), 0 0 0 1px var(--primary-glow);
    }

    .apex-tooltip-custom .tooltip-label {
      color: var(--primary);
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 6px;
      letter-spacing: 0.02em;
    }

    .apex-tooltip-custom .tooltip-value {
      color: var(--text-primary);
      font-size: 15px;
      font-weight: 700;
      font-family: var(--font-mono);
    }

    /* Modal Tooltip (dark background context) */
    .apex-tooltip-modal {
      background: linear-gradient(145deg, #1e2337 0%, #171b2b 100%);
      border: 1px solid rgba(129, 140, 248, 0.4);
      border-radius: 10px;
      padding: 12px 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);
    }

    .apex-tooltip-modal .tooltip-label {
      color: #a5b4fc;
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 6px;
      letter-spacing: 0.02em;
    }

    .apex-tooltip-modal .tooltip-value {
      color: #fff;
      font-size: 15px;
      font-weight: 700;
      font-family: var(--font-mono);
    }

    /* ═══════════════════════════════════════════════════════════════
       RESPONSIVE
       ═══════════════════════════════════════════════════════════════ */
    @media (max-width: 768px) {
      .wizard-steps {
        flex-wrap: wrap;
        gap: 1rem;
      }

      .wizard-connector {
        display: none;
      }

      .result-stats {
        grid-template-columns: repeat(2, 1fr);
      }

      .branch-section-row {
        grid-template-columns: 1fr;
      }

      .branch-chart-container {
        max-width: 100%;
      }

      .branch-breakdown-grid {
        grid-template-columns: 1fr;
      }

      .modal-chart-row {
        flex-direction: column;
      }

      .modal-branch-legend {
        flex-direction: row;
        flex-wrap: wrap;
        gap: 0.5rem;
      }

      .legend-item {
        flex: 0 0 auto;
      }

      .date-summary-row {
        flex-direction: column;
      }

      .date-summary-item {
        min-width: auto;
      }

      .modal {
        max-height: 95vh;
        margin: 0.5rem;
        max-width: 100%;
      }

      .detail-header-card {
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;
      }

      .detail-header-badges {
        align-self: flex-start;
      }

      .detail-prim-cards {
        grid-template-columns: 1fr;
      }

      .detail-grid {
        grid-template-columns: 1fr;
      }

      .detail-group.full-width {
        grid-column: span 1;
      }

      .floating-action-box {
        width: 100%;
        right: -100%;
        border-radius: 16px 16px 0 0;
        top: auto;
        bottom: 0;
        transform: none;
      }

      .floating-action-box.active {
        right: 0;
      }

      .card-footer {
        flex-direction: column;
        gap: 1rem;
      }

      .footer-actions {
        width: 100%;
        justify-content: flex-end;
      }
    }
  </style>

  <script src="../../assets/js/pages/policies/bulk-import.js"></script>
  <script src="../../assets/js/charts.js"></script>
  <script src="../../components/base.js"></script>
  <script src="../../components/toast.js"></script>
  <script src="../../components/modal.js"></script>
  <script src="../../components/sidebar.js"></script>
</body>
</html>
